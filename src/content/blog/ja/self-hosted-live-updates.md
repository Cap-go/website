---
slug: ja__self-hosted-live-updates
title: セルフホスト型のライブアップデート
description: 自己ホスト型のライブアップデート、Capgoライブアップデートの次のバージョンを発表できることを嬉しく思います！
author: Martin Donadieu
author_image_url: 'https://avatars.githubusercontent.com/u/4084527?v=4'
author_url: 'https://x.com/martindonadieu'
created_at: 2022-12-03T00:00:00.000Z
updated_at: 2023-06-29T00:00:00.000Z
head_image: /self_hosted.webp
head_image_alt: 自己ホスト型アップデート
tag: Solution
published: true
locale: ja
next_blog: ''
---

自己ホスト型ライブアップデートのリリースをお知らせできることに大変嬉しく思います。これはCapgoのライブアップデートの最新の進化を表しています。

現在、多くの企業がライブアップデートSDKを利用して、アプリケーションの最新のJavaScript、HTML、CSSのアップデートにアクセスしていますが、企業のポリシー、業界規制、地理的制限により障害が発生することもあります。自己ホスト型ライブアップデートを使用することで、インフラストラクチャを介してWebビルドアーティファクトを配布できるようになりました。

これにより、Apple Storeのレビューによる遅延を回避し、バグを修正し、コンテンツを迅速に変更し、ユーザーが常にアプリの最新バージョンを使用していることを保証できます。さらに、ライブアップデートを活用したいが、厳格なコンプライアンス基準により課題に直面している多くの大企業からもお声を聞いています。この問題は、自己ホスト型ライブアップデートのおかげで過去のものとなりました。

## 自己ホスト型ライブアップデートはどのように機能しますか？

Capgoがホストするライブアップデートの展開は、[Capgo SDK](https://githubcom/Cap-go/capacitor-updater/)を使用すれば簡単です。自己ホスト型ライブアップデートについては、インフラストラクチャでの設定を可能にするために必要な機能を含むCapgo CLIを強化しました。

最新のWebビルドアーティファクトをエンドユーザーに安全かつ調整された形で配信するために、CapgoはCapacitorライブアップデートプラグインが公開/非公開キーのペアリングを使用できるようにしました。自己ホスト型ライブアップデートを使用する際には、エンタープライズのインフラストラクチャからプラグイン経由でダウンロードされたアーティファクトが未変更であることを保証するために追加のハンドシェイクが行われます。

次に、キーのペアリングを確立し、その後、更新されたエクスペリエンスをエンドユーザーに配信するプロセスについて説明します。

### 一度きりのキー・ペア設定

公開/非公開キーのペアを生成するために、企業は以下のCapgo Cloud CLIコマンドを利用することができます：

```shell
npx @capgo/cli@latest key create
```

このコマンドは、configファイル内に`CapacitorUpdaterprivateKey`プロパティを設定します。
そして、プロジェクトのルートディレクトリに`capgo_keypub`と`capgo_key`という2つのキー・ファイルを生成します。

このキー・ペアは、アップデートに署名し、アプリ側でアップデートを検証するために使用されます。

### 自己ホスト型ライブアップデートのワークフロー

自己ホスト型ライブアップデートを実装するには、企業はまず、バグの修正、コンテンツの更新、または行いたい他のWebベースのコード変更のWebビルドを実行する必要があります。次に、ワンタイム設定プロセス中に取得した非公開キーを使用してビルドアーティファクトに署名し、最後にバンドルを希望するストレージ場所にアップロードします。

まずコードをビルドします：
```shell
npm run build
```

次にビルドをZIPします：
```shell
npx @capgo/cli/latest bundle zip
```

次にZIPを暗号化します：

```shell
npx @capgo/cli@latest bundle encrypt abc123.zip”
```

このコマンドは、次のステップのために保存する必要があるivSessionKeyを出力します。

次に、暗号化されたZIPを企業のストレージにアップロードし、ZIPファイルのURLを取得します。

Capgoには、消費の準備が整った新しいライブアップデートがあることを知らせる必要があります。これは別のCLIコマンドを介して行われます：

```shell
npx @capgo/cli@latest bundle upload --external=https://abc.com/app/updates/abc123.zip --iv-session-key=YourKey
```

コマンドを実行すると、Capgoは新しいアップデートがアプリのユーザーに配布される準備が整ったことを認識します。アプリが起動すると、ライブアップデートプラグインはCapgoに接続し、変更が必要かどうかを確認します。

Capgoは「はい、アップデートが利用可能です」とプラグインに応答し、ライブアップデートプラグインは`register` CLIコマンドから提供されたURLから新しいライブアップデートをダウンロードします：

```shell
https://abc.com/app/updates/abc123.zip
```

組織のAPIはその位置からライブアップデートバンドルを返し、アプリはZIPを解読し、ライブアップデートを適用します。これで完了です！

## 始める

ライブアップデートの利用範囲を以前よりもさらに多くの企業に広げることができ、非常に嬉しく思います。組織とIonicアプリのユーザーは、Capgoによる安全なオーバーザエアアプリ更新の利点をすぐに認識するでしょう。

Capgoの自己ホスト型ライブアップデートについての詳細情報は、[ドキュメントを確認する](/docs/tooling/cli/#upload-version)ことができます。ユーザーに直接インスタントアプリの更新をデプロイする準備はできていますか？ [ここで今すぐ登録！](/register/)