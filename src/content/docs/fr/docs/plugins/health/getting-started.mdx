---
title: Démarrage
description: Activez l'accès à HealthKit et Health Connect avec le plugin Capgo Health.
sidebar:
  order: 2
locale: fr
---

import { Steps } from '@astrojs/starlight/components';
import { PackageManagers } from 'starlight-package-managers'

<Steps>
1. **Installer le plugin**
   <PackageManagers pkg="@capgo/capacitor-health" pkgManagers={['npm', 'pnpm', 'yarn', 'bun']} />

2. **Synchroniser les projets natifs**
   <PackageManagers type="exec" pkg="cap" args="sync" pkgManagers={['npm', 'pnpm', 'yarn', 'bun']} />
</Steps>

## Configuration iOS

- Ouvrez `ios/App/App.xcworkspace` dans Xcode et activez la capacité **HealthKit**.
- Fournissez les descriptions d'utilisation dans `Info.plist` :

```xml
<key>NSHealthShareUsageDescription</key>
<string>This app reads your health metrics to personalize your experience.</string>
<key>NSHealthUpdateUsageDescription</key>
<string>This app writes health data that you explicitly record.</string>
```

## Configuration Android

Les données de santé sont alimentées par [Health Connect](https://developer.android.com/health-and-fitness/guides/health-connect). Assurez-vous que :

- `minSdkVersion` est **26 ou supérieur** (Capacitor 5 satisfait déjà cette exigence).
- Les utilisateurs ont Health Connect installé (Android 14+ l'inclut ; les versions antérieures nécessitent un téléchargement depuis le Play Store).
- Vous guidez les utilisateurs à travers l'interface de permission d'exécution lors de la demande d'accès.

## Vérifier la disponibilité et demander l'accès

```typescript
import { Health } from '@capgo/capacitor-health';

const { available, reason } = await Health.isAvailable();
if (!available) {
  console.warn('Health APIs unavailable:', reason);
  return;
}

await Health.requestAuthorization({
  read: ['steps', 'heartRate', 'weight'],
  write: ['weight'],
});
```

## Lire les échantillons

```typescript
const { samples } = await Health.readSamples({
  dataType: 'steps',
  startDate: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
  endDate: new Date().toISOString(),
  limit: 200,
});

samples.forEach((sample) => {
  console.log(sample.value, sample.startDate, sample.endDate);
});
```

## Écrire des échantillons

```typescript
await Health.saveSample({
  dataType: 'weight',
  value: 74.6,
  startDate: new Date().toISOString(),
});
```

## Gestion des autorisations

- Utilisez `checkAuthorization()` pour vérifier les portées de lecture/écriture actuelles et ajuster votre interface utilisateur.
- Gérez les refus avec élégance en expliquant pourquoi les données améliorent l'expérience et en offrant une nouvelle tentative.
- Respectez toujours la vie privée de l'utilisateur et ne demandez que les portées minimales requises par votre fonctionnalité.
