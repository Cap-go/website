---
title: Premiers pas
locale: fr
description: Configurez le plugin AudioSession pour réagir aux changements de route audio et aux interruptions sur iOS.
sidebar:
  order: 2
---

import { Steps } from '@astrojs/starlight/components';
import { PackageManagers } from 'starlight-package-managers'

> ℹ️ **Support de plateforme :** L'API audio session est disponible sur iOS. Les appels sur Android et le web se résolvent sans effet, vous permettant de conserver une logique partagée.

<Steps>
1. **Installez le package**
   <PackageManagers pkg="@capgo/capacitor-plugin-audiosession" pkgManagers={['npm', 'pnpm', 'yarn', 'bun']} />

2. **Synchronisez la plateforme iOS**
   <PackageManagers type="exec" pkg="cap" args="sync ios" pkgManagers={['npm', 'pnpm', 'yarn', 'bun']} />
</Steps>

## Inspecter les sorties disponibles

```typescript
import { AudioSession, AudioSessionPorts } from '@capgo/capacitor-plugin-audiosession';

const outputs = await AudioSession.currentOutputs();

if (outputs.includes(AudioSessionPorts.BLUETOOTH_A2DP)) {
  console.log('Enceinte Bluetooth connectée');
}
```

## Forcer le mode haut-parleur

```typescript
import { AudioSession, OutputOverrideType } from '@capgo/capacitor-plugin-audiosession';

await AudioSession.overrideOutput(OutputOverrideType.speaker);

// Restaurer le routage système lorsque vous avez terminé
await AudioSession.overrideOutput(OutputOverrideType.default);
```

## Écouter les événements de route et d'interruption

```typescript
import { AudioSession, RouteChangeReasons, InterruptionTypes } from '@capgo/capacitor-plugin-audiosession';

const routeListener = await AudioSession.addListener('routeChanged', (reason) => {
  if (reason === RouteChangeReasons.NEW_DEVICE_AVAILABLE) {
    console.log('L\'utilisateur a connecté une nouvelle route audio');
  }
});

const interruptionListener = await AudioSession.addListener('interruption', (type) => {
  if (type === InterruptionTypes.BEGAN) {
    // Mettre en pause la lecture pendant l'interruption
  } else {
    // Reprendre la lecture
  }
});

// Plus tard lors du nettoyage
await routeListener.remove();
await interruptionListener.remove();
```

## Droits

- **iOS** : Ajoutez tous les modes audio d'arrière-plan requis (par exemple `audio`, `voice`) dans `ios/App/App/Info.plist` si votre application lit de l'audio en arrière-plan.
- **Autres plateformes** : Aucune configuration supplémentaire n'est nécessaire ; les méthodes se résolvent avec des résultats vides.
