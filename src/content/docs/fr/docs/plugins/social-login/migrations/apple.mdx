---
title: Guide de migration de @capacitor-community/apple-sign-in vers @capgo/capacitor-social-login
locale: fr
description: Ce guide complet fournit des instructions détaillées pour la transition du plugin @capacitor-community/apple-sign-in vers le plugin @capgo/capacitor-social-login, garantissant un processus de migration fluide et des capacités améliorées.
sidebar:
    order: 1
---
import { Steps } from '@astrojs/starlight/components';

## Vue d'ensemble

Ce guide décrit la transition de l'ancien plugin `@capacitor-community/apple-sign-in` vers le package moderne `@capgo/capacitor-social-login`. Le nouveau plugin fournit une interface unifiée pour plusieurs fournisseurs d'authentification sociale avec un meilleur support TypeScript et une maintenance active.

## Installation

<Steps>
1. Supprimez l'ancien package :
   ```bash
   npm uninstall @capacitor-community/apple-sign-in
   ```

2. Installez le nouveau package :
   ```bash
   npm install @capgo/capacitor-social-login
   npx cap sync
   ```
</Steps>

## Modifications du code

### Modifications d'importation
```diff
- import { SignInWithApple } from '@capacitor-community/apple-sign-in';
+ import { SocialLogin } from '@capgo/capacitor-social-login';
```

### Initialisation

**Changement clé** : Le nouveau plugin nécessite une étape d'initialisation qui n'était pas nécessaire auparavant.

```diff
- // Aucune initialisation nécessaire dans l'ancien package
+ // Pour iOS : Configuration de base
+ await SocialLogin.initialize({
+   apple: {} // Configuration iOS de base
+ });

+ // Pour Android : Configuration supplémentaire requise
+ await SocialLogin.initialize({
+   apple: {
+     clientId: 'YOUR_SERVICE_ID', // Service ID du portail Apple Developer
+     redirectUrl: 'https://your-backend.com/callback' // URL de callback de votre backend
+   }
+ });
```

**Note importante** : Pour iOS, vous fournissez une configuration de base, tandis qu'Android nécessite des détails supplémentaires incluant un Service ID et une URL de callback backend pour l'authentification OAuth basée sur le web.

### Connexion

Le processus de connexion se simplifie de plusieurs paramètres à une API plus propre :

```diff
- const result = await SignInWithApple.authorize({
-   clientId: 'com.your.app',
-   redirectURI: 'https://your-app.com/callback',
-   scopes: 'email name',
-   state: '12345',
-   nonce: 'nonce'
- });

+ const result = await SocialLogin.login({
+   provider: 'apple',
+   options: {
+     // Optionnel : Ajoutez des scopes si nécessaire
+     scopes: ['email', 'name'],
+     nonce: 'nonce'
+   }
+ });
```

Le nouveau plugin utilise `login()` avec `provider: 'apple'` et des scopes optionnels plutôt que de passer des valeurs de configuration individuelles comme `clientId` et `redirectURI`.

### Modifications du type de réponse

Les résultats incluent maintenant un objet `accessToken` avec des détails d'expiration et une section `profile` structurée, remplaçant le format de réponse plus plat du package original :

```typescript
// Ancien type de réponse
interface AppleSignInResponse {
  response: {
    user: string;
    email: string | null;
    givenName: string | null;
    familyName: string | null;
    identityToken: string | null;
    authorizationCode: string | null;
  };
}

// Nouveau type de réponse
interface SocialLoginResponse {
  provider: 'apple';
  result: {
    accessToken: {
      token: string;
      expiresIn?: number;
      refreshToken?: string;
    } | null;
    idToken: string | null;
    profile: {
      user: string;
      email: string | null;
      givenName: string | null;
      familyName: string | null;
    };
  };
}
```

### Nouvelles capacités

Le plugin mis à jour introduit des fonctionnalités qui n'étaient pas disponibles dans le prédécesseur :

**Vérification de l'état de connexion**
```diff
- // Non disponible dans l'ancien package
+ const status = await SocialLogin.isLoggedIn({
+   provider: 'apple'
+ });
```

**Fonctionnalité de déconnexion**
```diff
- // Non disponible dans l'ancien package
+ await SocialLogin.logout({
+   provider: 'apple'
+ });
```

Ces méthodes fournissent `isLoggedIn()` pour vérifier l'état d'authentification et la fonctionnalité `logout()`.

## Modifications spécifiques à la plateforme

### Configuration iOS

**iOS** maintient des procédures de configuration familières via les capacités Xcode :

1. La configuration iOS reste largement identique. Vous devez toujours :
   - Activer la capacité "Sign In with Apple" dans Xcode
   - Configurer votre application dans le portail Apple Developer
   - Aucune modification de code supplémentaire requise pour iOS

### Configuration Android

**Android** reçoit maintenant un support natif via l'authentification OAuth basée sur le web :

Le nouveau plugin fournit un support Android prêt à l'emploi, mais nécessite une configuration supplémentaire :

1. Créer un Services ID dans le portail Apple Developer
2. Configurer un endpoint d'authentification web
3. Configurer votre application Android pour gérer le flux OAuth
4. La configuration du service backend est requise

Pour des instructions détaillées de configuration Android, veuillez consulter le [Guide de configuration Android](/docs/plugins/social-login/apple/android/).

## Avantages clés

Le package modernisé fournit :

1. **API unifiées** pour plusieurs fournisseurs sociaux (Google, Facebook, Apple)
2. **Typage TypeScript amélioré** avec de meilleures définitions de types
3. **Maintenance communautaire active** par rapport à la version obsolète
4. **Support Android intégré** via l'authentification basée sur le web
5. **Gestion persistante de l'état de connexion**
6. **Meilleure gestion des erreurs** avec des types d'erreurs cohérents

## Changements majeurs

1. **L'initialisation explicite est maintenant requise** - pas de configuration par défaut
2. **La structure de l'objet de réponse a changé** - format de résultat imbriqué
3. **L'implémentation Android nécessite un service backend** pour OAuth
4. **La gestion du rafraîchissement des jetons est différente** - gestion améliorée des jetons
5. **La gestion des erreurs et les types d'erreurs ont changé** - erreurs plus détaillées

Pour des instructions de configuration plus détaillées, veuillez consulter la [documentation officielle](/docs/plugins/social-login/apple/general/).
