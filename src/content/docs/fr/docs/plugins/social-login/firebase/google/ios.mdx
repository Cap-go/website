---
title: Connexion Google Firebase sur iOS
locale: fr
description: Apprenez à configurer la connexion Google avec Firebase Authentication sur iOS en utilisant le plugin Capacitor Social Login.
sidebar:
    order: 3
---
import { Steps } from '@astrojs/starlight/components';

## Introduction

Ce guide vous aidera à intégrer la connexion Google avec Firebase Authentication sur iOS. Je suppose que vous avez déjà terminé la [configuration générale de Firebase Google](./general/).

:::note
Je vais supposer que vous n'avez pas encore créé votre application iOS dans la Console Firebase. Si vous l'avez fait, vos étapes seront légèrement différentes.
:::

## Étapes de Configuration

<Steps>
1. Accédez à l'aperçu de votre projet sur [console.cloud.google.com](https://console.cloud.google.com/)
    <img src="/social-login-assets/firebase_project_overview.webp" alt="Firebase Project Overview" />

2. Cliquez sur le bouton `Add app`
    <img src="/social-login-assets/firebase_project_add_app.webp" alt="Firebase Add App Button" />

    :::note
    Il est possible que vous deviez chercher ce bouton ici. Cela s'applique uniquement si vous avez déjà créé une application différente dans la Console Firebase.
    :::

    <img src="/social-login-assets/firebase_project_add_app_2.webp" alt="Firebase Add App Button" />
3. Sélectionnez `iOS`
    <img src="/social-login-assets/firebase_project_add_app_ios.webp" alt="Firebase Add App iOS Button" />

4. Remplissez la première partie du formulaire
   1. Remplissez le `Apple bundle ID`
      1. Ouvrez Xcode à votre application en utilisant `npx cap open ios`
      2. Double-cliquez sur `App`
         <img src="/social-login-assets/xcode_app_click.png" alt="App target in Xcode project navigator" />
      3. Assurez-vous que vous êtes sur `Targets -> App`
         <img src="/social-login-assets/xcode_targets_app.png" alt="Targets section in Xcode with App selected" />
      4. Trouvez votre `Bundle Identifier`
          <img src="/social-login-assets/xcode_bundle_id.png" alt="Bundle Identifier field in Xcode project settings" />
          :::note
          L'ID affiché ici sera différent de celui que j'utiliserai pour le reste du guide. J'utiliserai `app.capgo.plugin.SocialLogin` pour le reste du guide.
          :::
      5. Copiez le `Bundle Identifier` et collez-le dans la console Firebase
         <img src="/social-login-assets/firebase_project_add_app_ios_bundle_id.webp" alt="Firebase Add App iOS Bundle ID Field" />
   2. Cliquez sur le bouton `Register app`
         <img src="/social-login-assets/firebase_project_add_app_ios_register.webp" alt="Firebase Add App iOS Register Button" />
5. Passez l'étape `Download config file`
    <img src="/social-login-assets/firebase_project_add_app_ios_skip_download.webp" alt="Firebase Add App iOS Skip Download Button" />
6. Passez l'étape `Add firebase SDK`
    <img src="/social-login-assets/firebase_project_add_app_ios_skip_download_firebase_sdk_2.webp" alt="Firebase Add App iOS Skip Download Firebase SDK Button" />
7. Passez l'étape `Add initialization code`
    <img src="/social-login-assets/firebase_project_add_app_ios_skip_download_firebase_sdk.webp" alt="Firebase Add App iOS Skip Add Initialization Code Button" />
8. Cliquez sur le bouton `Continue to console`
    <img src="/social-login-assets/firebase_project_add_app_ios_continue_to_console.webp" alt="Firebase Add App iOS Continue to Console Button" />
9. Obtenez votre iOS client ID et votre `YOUR_DOT_REVERSED_IOS_CLIENT_ID`
   1. Allez sur Google Cloud Console à [console.cloud.google.com](https://console.cloud.google.com/)
   2. Trouvez votre projet
      1. Cliquez sur le sélecteur de projet
         <img src="/social-login-assets/firebase_double_check_gc_project_select.webp" alt="Google Cloud Console Project Selector" />
      2. Recherchez votre projet par le nom exact de votre projet Firebase et cliquez dessus. Dans mon cas, c'est `sociallogin-tutorial-app`.
         <img src="/social-login-assets/firebase_gc_project_select_project.webp" alt="Firebase Project Selector Project" />
   3. Ouvrez la barre de recherche et ouvrez `credentials`
      1. Ouvrez la barre de recherche
         <img src="/social-login-assets/firebase_double_check_gc_search_bar.webp" alt="Google Cloud Console Search Bar" />
      2. Recherchez `credentials` et cliquez sur celui des `APIs and Services` (numéro 2 sur la capture d'écran)
         <img src="/social-login-assets/firebase_gc_credentials_search.webp" alt="Google Cloud Console Credentials Search" />
   4. Cliquez sur le `iOS client for [YOUR_APP_ID] (auto created by Google Service)`. Dans mon cas, c'est `sociallogin-tutorial-app`.
      <img src="/social-login-assets/firebase_gc_credentials_ios_client_id.webp" alt="Google Cloud Console Credentials iOS Client ID" />
   5. Copiez le `Client ID` ainsi que le `iOS URL scheme`. Ce sera respectivement votre `iOSClientId` et `YOUR_DOT_REVERSED_IOS_CLIENT_ID`.

      :::note
      Vous passerez le `iOSClientId` dans la méthode `initialize` du plugin, tandis que vous utiliserez le `YOUR_DOT_REVERSED_IOS_CLIENT_ID` dans le fichier `Info.plist` de votre application, comme expliqué dans la partie suivante de ce guide.
      :::

      <img src="/social-login-assets/firebase_gc_credentials_ios_client_id_copy.webp" alt="Google Cloud Console Credentials iOS Client ID Copy" />
10. Obtenez votre web client ID
    1. Retournez à la console Firebase et allez dans `Build` -> `Authentication`
        <img src="/social-login-assets/firebase_select_authentication.webp" alt="Firebase Authentication Menu" />
    2. Cliquez sur le bouton `Sign-in method`
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method.webp" alt="Firebase Authentication Sign-in Method Button" />
    3. Cliquez sur le fournisseur `Google`
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method_google.webp" alt="Firebase Authentication Sign-in Method Google Provider" />
    4. Cliquez sur le bouton `Web SDK configuration`
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method_web_sdk_configuration.webp" alt="Firebase Authentication Sign-in Method Web SDK Configuration Button" />
    5. Copiez le `Web client ID`. Ce sera votre `webClientId` dans la méthode `initialize` du plugin.
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method_web_sdk_configuration_web_client_id.webp" alt="Firebase Authentication Sign-in Method Web SDK Configuration Web Client ID" />
11. Modifiez le fichier Info.plist de votre application
    1. Ouvrez Xcode et trouvez le fichier `Info.plist`
        <img src="/social-login-assets/xcode_info_file.png" alt="Info.plist file in Xcode project navigator" />
    2. Faites un clic droit sur ce fichier et ouvrez-le en tant que code source
        <img src="/social-login-assets/xcode_open_as_src_code.png" alt="Right-click menu showing Open As Source Code option" />
    3. En bas de votre fichier `Plist`, vous verrez une balise `</dict>`
        <img src="/social-login-assets/xcode_dict_tag.png" alt="Closing dict tag in Info.plist file" />
    4. Insérez le fragment suivant juste avant la balise de fermeture `</dict>`
        <img src="/social-login-assets/xcode_plist_inserted.png" alt="Info.plist with URL schemes code inserted before closing dict tag" />

        ```xml
        <key>CFBundleURLTypes</key>
        <array>
        <dict>
          <key>CFBundleURLSchemes</key>
          <array>
            <string>YOUR_DOT_REVERSED_IOS_CLIENT_ID</string>
          </array>
        </dict>
        </array>
        <key>GIDClientID</key>
        <string>YOUR_IOS_CLIENT_ID.apps.googleusercontent.com</string>
        ```

    5. Remplacez le `YOUR_DOT_REVERSED_IOS_CLIENT_ID` par la valeur copiée à l'étape 9 (le iOS URL scheme)
        <img src="/social-login-assets/xcode_plist_final.png" alt="Info.plist with actual reversed client ID inserted in URL schemes" />

        :::caution
        Assurez-vous que cette valeur **COMMENCE** par `com.googleusercontent.apps`
        :::

   6. Remplacez le `YOUR_IOS_CLIENT_ID` par l'iOS Client ID que vous avez copié à l'étape 9

   7. Enregistrez le fichier avec `Command + S`

12. Modifiez le `AppDelegate.swift`
    1. Ouvrez le AppDelegate
        <img src="/social-login-assets/xcode_app_deleg.png" alt="AppDelegate.swift file in Xcode project navigator" />
    2. Insérez `import GoogleSignIn` en haut du fichier
        <img src="/social-login-assets/xcode_app_deleg_google_sign_in.png" alt="AppDelegate.swift with GoogleSignIn import added" />
    3. Trouvez la fonction `func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:])`
        <img src="/social-login-assets/xcode_app_deleg_app_fn.png" alt="Original application openURL function in AppDelegate" />
    4. Modifiez la fonction pour qu'elle ressemble à ceci

        ```swift
        func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:]) -> Bool {
            // Called when the app was launched with a url. Feel free to add additional processing here,
            // but if you want the App API to support tracking app url opens, make sure to keep this call

            var handled: Bool

            handled = GIDSignIn.sharedInstance.handle(url)
            if handled {
              return true
            }

            return ApplicationDelegateProxy.shared.application(app, open: url, options: options)
        }
        ```

        <img src="/social-login-assets/xcode_app_deleg_app_fn_mod.png" alt="Modified application openURL function with GoogleSignIn handling" />

    5. Enregistrez le fichier avec `Command + S`

15. Utilisation de la connexion Google dans votre application

    À cette étape, vous êtes prêt à utiliser la connexion Google dans votre application.
    Veuillez utiliser le fichier [authUtils.ts](https://github.com/Cap-go/capacitor-social-login/blob/main/example-app/src/authUtils.ts) de l'application exemple pour vous authentifier avec Google.
</Steps>

 L'utilisateur sera automatiquement créé dans Firebase Auth lors de la première connexion

## Dépannage

Si l'authentification se bloque ou échoue :

- Vérifiez que l'audience du `idToken` correspond à votre web client ID Firebase
- Vérifiez que la connexion Google est activée dans la Console Firebase
- Assurez-vous que Info.plist contient les bons schémas d'URL et GIDClientID
- Vérifiez que `iOSServerClientId` correspond à votre web client ID
- Consultez le [code de l'application exemple](https://github.com/Cap-go/capacitor-social-login/tree/main/example-app/src/authUtils.ts) pour référence

