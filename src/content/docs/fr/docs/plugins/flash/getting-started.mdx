---
title: Démarrage
description: Apprenez à installer et utiliser le plugin Flash pour contrôler la lampe torche de votre appareil dans votre application Capacitor.
sidebar:
  order: 2
locale: fr
---

import { Tabs, TabItem } from '@astrojs/starlight/components';
import { Code, Steps } from '@astrojs/starlight/components';
import { PackageManagers } from 'starlight-package-managers'

<Steps>
1. **Installer le package**
   <PackageManagers pkg="@capgo/capacitor-flash" pkgManagers={['npm', 'pnpm', 'yarn', 'bun']} />

2. **Synchroniser avec les projets natifs**
   <PackageManagers type="exec" pkg="cap" args="sync" pkgManagers={['npm', 'pnpm', 'yarn', 'bun']} />
</Steps>

## Utilisation

Importez le plugin et utilisez ses méthodes pour contrôler la lampe torche :

```typescript
import { CapacitorFlash } from '@capgo/capacitor-flash';

// Check if flashlight is available
const checkFlashlight = async () => {
  const { value } = await CapacitorFlash.isAvailable();
  console.log('Flashlight available:', value);
};

// Turn on flashlight
const turnOn = async () => {
  await CapacitorFlash.switchOn();
};

// Turn off flashlight
const turnOff = async () => {
  await CapacitorFlash.switchOff();
};

// Check if flashlight is on
const checkStatus = async () => {
  const { value } = await CapacitorFlash.isSwitchedOn();
  console.log('Flashlight is on:', value);
};

// Toggle flashlight
const toggle = async () => {
  await CapacitorFlash.toggle();
};
```

## Référence API

### isAvailable()

Vérifie si la lampe torche est disponible sur l'appareil.

```typescript
const result = await CapacitorFlash.isAvailable();
// Returns: { value: boolean }
```

### switchOn(options?)

Allume la lampe torche.

```typescript
interface SwitchOnOptions {
  intensity?: number; // 0.0 to 1.0 (iOS only)
}

await CapacitorFlash.switchOn({ intensity: 0.5 });
```

### switchOff()

Éteint la lampe torche.

```typescript
await CapacitorFlash.switchOff();
```

### isSwitchedOn()

Vérifie si la lampe torche est actuellement allumée.

```typescript
const result = await CapacitorFlash.isSwitchedOn();
// Returns: { value: boolean }
```

### toggle()

Bascule la lampe torche (on/off).

```typescript
await CapacitorFlash.toggle();
```

## Exemple complet

```typescript
import { CapacitorFlash } from '@capgo/capacitor-flash';

export class FlashlightService {
  private isOn = false;

  async init() {
    const { value } = await CapacitorFlash.isAvailable();
    if (!value) {
      throw new Error('Flashlight not available on this device');
    }
  }

  async toggle() {
    if (this.isOn) {
      await CapacitorFlash.switchOff();
    } else {
      await CapacitorFlash.switchOn();
    }
    this.isOn = !this.isOn;
  }

  async turnOn(intensity?: number) {
    await CapacitorFlash.switchOn({ intensity });
    this.isOn = true;
  }

  async turnOff() {
    await CapacitorFlash.switchOff();
    this.isOn = false;
  }

  async strobe(intervalMs: number = 100, duration: number = 3000) {
    const endTime = Date.now() + duration;

    while (Date.now() < endTime) {
      await CapacitorFlash.toggle();
      await new Promise(resolve => setTimeout(resolve, intervalMs));
    }

    // Ensure flashlight is off after strobe
    await CapacitorFlash.switchOff();
    this.isOn = false;
  }
}
```

## Bonnes pratiques

1. **Vérifiez la disponibilité en premier**
   Vérifiez toujours la disponibilité de la lampe torche avant de l'utiliser :
   ```typescript
   const { value } = await CapacitorFlash.isAvailable();
   if (!value) {
     // Show alternative UI or disable flashlight features
   }
   ```

2. **Gérez les erreurs gracieusement**
   ```typescript
   try {
     await CapacitorFlash.switchOn();
   } catch (error) {
     console.error('Failed to turn on flashlight:', error);
   }
   ```

3. **Éteignez quand ce n'est pas nécessaire**
   Éteignez toujours la lampe torche lorsque votre application passe en arrière-plan ou lorsque la fonctionnalité n'est plus nécessaire pour économiser la batterie.

4. **Évitez les basculements rapides**
   Implémentez un anti-rebond pour éviter les allumages/extinctions rapides qui pourraient endommager la LED ou vider la batterie.

## Notes de plateforme

### iOS
- Nécessite iOS 10.0+
- Utilise le mode torche `AVCaptureDevice`
- Prend en charge le contrôle de l'intensité (0.0 à 1.0)

### Android
- Nécessite Android 6.0 (API 23)+
- Utilise l'API Camera2
- Le contrôle de l'intensité n'est pas pris en charge (utilise la luminosité par défaut)

### Web
- Pris en charge sur les navigateurs avec API MediaDevices et capacité torche
- Utilise le flux de la caméra pour accéder à la lampe torche de l'appareil
- Nécessite la permission de l'utilisateur pour accéder à la caméra
- Fonctionne mieux sur les navigateurs mobiles (Chrome sur Android)
- Les navigateurs de bureau renvoient généralement `isAvailable: false` (pas de matériel torche)
- Le contrôle de l'intensité n'est pas pris en charge sur le web
