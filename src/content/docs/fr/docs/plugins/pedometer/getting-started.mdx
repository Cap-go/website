---
title: "Premiers pas avec Pedometer"
locale: fr
description: "Apprenez à intégrer le comptage de pas et le suivi de la condition physique dans votre application Capacitor"
---

Ce guide vous guidera dans l'intégration du plugin Capacitor Pedometer dans votre application.

## Installation

Installez le plugin en utilisant npm :

```bash
npm install @capgo/capacitor-pedometer
npx cap sync
```

## Configuration iOS

Ajoutez la description d'utilisation du mouvement à votre `Info.plist` :

```xml
<key>NSMotionUsageDescription</key>
<string>Nous avons besoin d'accéder à vos données de mouvement pour suivre les pas et l'activité</string>
```

## Configuration Android

Le plugin ajoute automatiquement la permission `ACTIVITY_RECOGNITION`. Pour Android 10+ (API 29), vous devez demander cette permission lors de l'exécution.

## Utilisation de base

### Importer le plugin

```typescript
import { CapacitorPedometer } from '@capgo/capacitor-pedometer';
```

### Vérifier la disponibilité

```typescript
const checkPedometer = async () => {
  const result = await CapacitorPedometer.isAvailable();
  console.log('Comptage de pas disponible:', result.stepCounting);
  console.log('Distance disponible:', result.distance);
  console.log('Comptage d\'étages disponible:', result.floorCounting);
  console.log('Allure disponible:', result.pace);
  console.log('Cadence disponible:', result.cadence);
};
```

### Demander les permissions

```typescript
const requestPermission = async () => {
  const permission = await CapacitorPedometer.requestPermissions();
  console.log('Statut de la permission:', permission.activityRecognition);
};
```

### Obtenir les mesures actuelles

```typescript
const getMeasurements = async () => {
  const measurements = await CapacitorPedometer.getMeasurement({
    startDate: new Date(Date.now() - 24 * 60 * 60 * 1000), // Il y a 24 heures
    endDate: new Date()
  });

  console.log('Pas:', measurements.numberOfSteps);
  console.log('Distance:', measurements.distance, 'mètres');
  console.log('Étages montés:', measurements.floorsAscended);
  console.log('Étages descendus:', measurements.floorsDescended);
};
```

### Démarrer les mises à jour en temps réel

```typescript
// Ajouter un écouteur pour les mises à jour en temps réel
CapacitorPedometer.addListener('measurement', (data) => {
  console.log('Pas:', data.numberOfSteps);
  console.log('Distance:', data.distance);
  console.log('Allure:', data.currentPace);
  console.log('Cadence:', data.currentCadence);
});

// Commencer à recevoir les mises à jour
await CapacitorPedometer.startMeasurementUpdates();
```

### Arrêter les mises à jour

```typescript
await CapacitorPedometer.stopMeasurementUpdates();
CapacitorPedometer.removeAllListeners();
```

## Exemple complet

```typescript
import { CapacitorPedometer } from '@capgo/capacitor-pedometer';

class PedometerService {
  private listener: any;

  async initialize() {
    // Vérifier la disponibilité
    const available = await CapacitorPedometer.isAvailable();
    if (!available.stepCounting) {
      console.error('Comptage de pas non disponible');
      return false;
    }

    // Demander les permissions
    const permission = await CapacitorPedometer.requestPermissions();
    if (permission.activityRecognition !== 'granted') {
      console.error('Permission refusée');
      return false;
    }

    return true;
  }

  async startTracking() {
    // Ajouter un écouteur
    this.listener = CapacitorPedometer.addListener('measurement', (data) => {
      this.onMeasurement(data);
    });

    // Démarrer les mises à jour
    await CapacitorPedometer.startMeasurementUpdates();
    console.log('Suivi du podomètre démarré');
  }

  async stopTracking() {
    await CapacitorPedometer.stopMeasurementUpdates();
    if (this.listener) {
      this.listener.remove();
    }
    console.log('Suivi du podomètre arrêté');
  }

  onMeasurement(data: any) {
    console.log('Pas aujourd\'hui:', data.numberOfSteps);
    console.log('Distance:', (data.distance / 1000).toFixed(2), 'km');
  }

  async getTodaySteps() {
    const today = new Date();
    today.setHours(0, 0, 0, 0);

    const measurements = await CapacitorPedometer.getMeasurement({
      startDate: today,
      endDate: new Date()
    });

    return measurements.numberOfSteps;
  }
}

// Utilisation
const pedometer = new PedometerService();
await pedometer.initialize();
await pedometer.startTracking();
```

## Bonnes pratiques

1. **Vérifier la disponibilité** : Toujours vérifier les fonctionnalités du podomètre avant utilisation
2. **Demander les permissions** : Gérer les demandes de permission avec élégance
3. **Optimisation de la batterie** : Arrêter les mises à jour lorsqu'elles ne sont pas nécessaires
4. **Gestion des erreurs** : Envelopper les appels dans des blocs try-catch
5. **Mises à jour en arrière-plan** : Configurer les modes d'arrière-plan pour un suivi continu

## Problèmes courants

### Permission refusée

```typescript
const handlePermissionDenied = async () => {
  const permission = await CapacitorPedometer.checkPermissions();

  if (permission.activityRecognition === 'denied') {
    alert('La permission de suivi des mouvements est requise. Veuillez l\'activer dans les Paramètres.');
  }
};
```

### Non disponible sur l'appareil

```typescript
const checkSupport = async () => {
  const available = await CapacitorPedometer.isAvailable();

  if (!available.stepCounting) {
    alert('Le comptage de pas n\'est pas disponible sur cet appareil');
    return false;
  }

  return true;
};
```

## Prochaines étapes

- Explorez la [Référence API](https://github.com/Cap-go/capacitor-pedometer#api) pour la documentation complète
- Consultez l'[application exemple](https://github.com/Cap-go/capacitor-pedometer/tree/main/example)
- Voir le [tutoriel](/plugins-tutorials/capacitor-pedometer) pour une implémentation avancée
