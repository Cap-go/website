---
title: "Membres"
description: "Guide complet pour gérer les membres de l'organisation dans Capgo, couvrant les rôles, les permissions et les meilleures pratiques pour la sécurité et la collaboration."
sidebar:
  order: 4
---

Les membres de l'organisation sont des utilisateurs qui ont accès à votre organisation Capgo. Chaque membre a un rôle spécifique qui détermine ses permissions au sein de l'organisation. Une gestion efficace des membres est essentielle pour maintenir la sécurité et la collaboration au sein de votre équipe.

## Rôles des Membres

### Rôles Réguliers
- **read**: Peut consulter les ressources mais ne peut pas apporter de modifications
- **upload**: Peut télécharger de nouveaux paquets et consulter les ressources
- **write**: Peut modifier les ressources et télécharger des paquets
- **admin**: Peut gérer les paramètres de l'organisation et les membres
- **super_admin**: A un contrôle total sur l'organisation

### Rôles d'Invitation
- **invite_read**: Invitation en attente pour l'accès en lecture
- **invite_upload**: Invitation en attente pour l'accès au téléchargement
- **invite_write**: Invitation en attente pour l'accès en écriture
- **invite_admin**: Invitation en attente pour l'accès administrateur
- **invite_super_admin**: Invitation en attente pour l'accès super administrateur

## Meilleures Pratiques

1. **Attribution des Rôles**: Suivez le principe du moindre privilège lors de l'attribution des rôles
2. **Audits Réguliers**: Examinez périodiquement l'accès des membres et supprimez les comptes inutilisés
3. **Intégration**: Ayez un processus clair pour ajouter de nouveaux membres et attribuer des rôles
4. **Départ**: Supprimez rapidement l'accès des membres qui quittent l'organisation

## Endpoints

### POST

`https://api.capgo.app/organization/members/`

Ajoutez un nouveau membre à une organisation ou mettez à jour le rôle d'un membre existant. Notez que vous ne pouvez inviter que des utilisateurs qui ont déjà un compte Capgo - l'e-mail doit correspondre à un utilisateur Capgo existant.

#### Request Body

```typescript
interface MemberCreate {
  orgId: string
  email: string
  role: "read" | "upload" | "write" | "admin" | "super_admin"
}
```

#### Exemple de Requête

```bash
curl -X POST \
  -H "authorization: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "orgId": "org_123",
    "email": "newmember@example.com",
    "role": "write"
  }' \
  https://api.capgo.app/organization/members/
```

#### Réponse de Succès

```json
{
  "status": "OK",
  "data": {
    "uid": "user_789",
    "email": "newmember@example.com",
    "role": "invite_write",
    "image_url": null
  }
}
```

Notes : 
- Lors de l'ajout d'un nouveau membre, il recevra un e-mail d'invitation. Son rôle sera préfixé par "invite_" jusqu'à ce qu'il accepte l'invitation.
- L'utilisateur doit déjà avoir un compte Capgo avant de pouvoir être invité. S'il n'a pas de compte, il doit d'abord en créer un sur https://console.capgo.app/register/

### GET 

`https://api.capgo.app/organization/members/`

Récupérez tous les membres d'une organisation.

#### Paramètres de Requête

```typescript
interface MemberQuery {
  orgId: string
}
```

#### Type de Réponse

```typescript
interface Member {
  uid: string;
  email: string;
  image_url: string;
  role: "invite_read" | "invite_upload" | "invite_write" | "invite_admin" | "invite_super_admin" | "read" | "upload" | "write" | "admin" | "super_admin";
}
```

#### Exemple de Requête

```bash
curl -H "authorization: your-api-key" \
  "https://api.capgo.app/organization/members/?orgId=org_123"
```

#### Exemple de Réponse

```json
{
  "data": [
    {
      "uid": "user_123",
      "email": "john@example.com",
      "image_url": "https://example.com/avatar.png",
      "role": "admin"
    },
    {
      "uid": "user_456",
      "email": "jane@example.com",
      "image_url": "https://example.com/avatar2.png",
      "role": "write"
    },
    {
      "uid": "user_789",
      "email": "bob@example.com",
      "image_url": null,
      "role": "invite_read"
    }
  ]
}
```

### DELETE

`https://api.capgo.app/organization/members/`

Supprimez un membre d'une organisation. Cela révoquera immédiatement son accès.

#### Request Body

```typescript
interface MemberDelete {
  orgId: string
  email: string
}
```

#### Exemple de Requête

```bash
curl -X DELETE \
  -H "authorization: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "orgId": "org_123",
    "email": "user@example.com"
  }' \
  https://api.capgo.app/organization/members/
```

#### Réponse de Succès

```json
{
  "status": "OK"
}
```

## Gestion des Erreurs

Scénarios d'erreur courants et leurs réponses :

```json
// Membre non trouvé
{
  "error": "Member not found",
  "status": "KO"
}

// Rôle invalide
{
  "error": "Invalid role specified",
  "status": "KO"
}

// Permission refusée
{
  "error": "Insufficient permissions to manage members",
  "status": "KO"
}

// Impossible de supprimer le dernier administrateur
{
  "error": "Cannot remove the last admin from the organization",
  "status": "KO"
}

// E-mail invalide
{
  "error": "Invalid email format",
  "status": "KO"
}

// Le membre existe déjà
{
  "error": "Member already exists in organization",
  "status": "KO"
}
```

## Cas d'Usage Courants

1. **Expansion de l'Équipe**: Ajout de nouveaux membres de l'équipe avec des rôles appropriés
2. **Contrôle d'Accès**: Gestion des permissions des membres à mesure que les responsabilités changent
3. **Audit de Sécurité**: Examen périodique de la liste des membres et des rôles
4. **Restructuration de l'Équipe**: Mise à jour des rôles lors de changements organisationnels
