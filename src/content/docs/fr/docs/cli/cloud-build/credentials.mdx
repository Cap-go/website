---
title: Gestion des identifiants
description: Enregistrer et g√©rer les identifiants de build localement pour les builds iOS et Android
locale: fr
sidebar:
  order: 5
---

import { Steps, Aside } from '@astrojs/starlight/components';

G√©rez vos identifiants de build iOS et Android localement pour des builds cloud pratiques.

## Vue d'ensemble

Le CLI Capgo vous permet d'enregistrer les identifiants de build localement sur votre machine dans le dossier `.capgo-credentials`. Lorsque vous lancez un build, ces identifiants sont automatiquement utilis√©s et envoy√©s de mani√®re s√©curis√©e aux serveurs de build de Capgo.

<Aside type="tip" title="Besoin d'aide pour obtenir les identifiants ?">
Si vous n'avez pas encore vos certificats et identifiants, consultez ces guides complets :

**iOS :**
- [Comment obtenir les certificats iOS](/docs/cli/cloud-build/ios/#how-to-get-ios-certificates-and-provisioning-profiles) - Guide √©tape par √©tape
- [Guide des certificats iOS (Capawesome)](https://capawesome.io/cloud/native-builds/certificates/ios/) - Tutoriel d√©taill√© avec captures d'√©cran
- [Blog : Builds iOS automatiques](https://capgo.app/blog/automatic-capacitor-ios-build-github-action/) - Configuration compl√®te CI/CD

**Android :**
- [Cr√©er un keystore](/docs/cli/cloud-build/android/#creating-a-keystore) - Guide √©tape par √©tape
- [Guide des certificats Android (Capawesome)](https://capawesome.io/cloud/native-builds/certificates/android/) - Tutoriel d√©taill√© avec captures d'√©cran
- [Blog : Builds Android automatiques](https://capgo.app/blog/automatic-capacitor-android-build-github-action/) - Configuration compl√®te CI/CD
</Aside>

<Aside type="caution" title="Garantie de s√©curit√©">
**Vos identifiants ne sont JAMAIS stock√©s de mani√®re permanente sur les serveurs Capgo :**
- ‚úÖ Utilis√©s UNIQUEMENT pendant le processus de build actif
- ‚úÖ Automatiquement supprim√©s apr√®s la fin du build
- ‚úÖ R√©tention maximale : 24 heures (m√™me en cas d'√©chec du build)
- ‚úÖ Les applications sont envoy√©es directement √† l'App Store/Play Store - nous ne stockons RIEN
- ‚úÖ Transmis de mani√®re s√©curis√©e via HTTPS
</Aside>

## Commandes

### Enregistrer les identifiants

Stockez vos identifiants de build localement pour une utilisation automatique :

```bash
npx @capgo/cli build credentials save --platform <ios|android> [options]
```

### Lister les identifiants

Afficher les identifiants actuellement enregistr√©s (les mots de passe sont masqu√©s) :

```bash
npx @capgo/cli build credentials list
```

### Effacer les identifiants

Supprimer les identifiants enregistr√©s de votre machine locale :

```bash
# Effacer tous les identifiants
npx @capgo/cli build credentials clear

# Effacer uniquement les identifiants iOS
npx @capgo/cli build credentials clear --platform ios

# Effacer uniquement les identifiants Android
npx @capgo/cli build credentials clear --platform android
```

## Enregistrer les identifiants iOS

<Aside type="note">
**Vous n'avez pas encore de certificats iOS ?** Consultez le [guide des builds iOS](/docs/cli/cloud-build/ios/#how-to-get-ios-certificates-and-provisioning-profiles) pour obtenir des instructions sur la cr√©ation de certificats et profils de provisionnement.
</Aside>

### Exemple complet

```bash
npx @capgo/cli build credentials save \
  --platform ios \
  --certificate ./cert.p12 \
  --p12-password "YourP12Password" \
  --provisioning-profile ./profile.mobileprovision \
  --apple-key ./AuthKey_ABC1234567.p8 \
  --apple-key-id "ABC1234567" \
  --apple-issuer-id "00000000-0000-0000-0000-000000000000" \
  --apple-team-id "TEAM123456"
```

### Options iOS

| Option | Description | Requis |
|--------|-------------|----------|
| `--certificate <path>` | Chemin vers le fichier de certificat .p12 | Oui (release) |
| `--p12-password <password>` | Mot de passe du certificat .p12 | Oui (release) |
| `--provisioning-profile <path>` | Chemin vers le fichier .mobileprovision | Oui (release) |
| `--provisioning-profile-prod <path>` | Profil de provisionnement de production (optionnel) | Non |
| `--apple-key <path>` | Chemin vers la cl√© API .p8 App Store Connect | Oui (soumission) |
| `--apple-key-id <id>` | ID de la cl√© API App Store Connect | Oui (soumission) |
| `--apple-issuer-id <id>` | ID de l'√©metteur de l'API App Store Connect (UUID) | Oui (soumission) |
| `--apple-team-id <id>` | ID de l'√©quipe App Store Connect | Oui (soumission) |
| `--apple-id <email>` | Email de l'identifiant Apple (authentification alternative) | Non |
| `--apple-app-password <password>` | Mot de passe sp√©cifique √† l'application (authentification alternative) | Non |

### Ce qui est stock√©

Lorsque vous enregistrez les identifiants iOS, le CLI :
1. Lit les fichiers de certificat et de profil de provisionnement
2. Les convertit en encodage base64
3. Enregistre les identifiants dans le dossier `.capgo-credentials`
4. Stocke les mots de passe et ID en texte brut (fichiers locaux uniquement)

La structure de fichier stock√©e :
```json
{
  "ios": {
    "BUILD_CERTIFICATE_BASE64": "...",
    "BUILD_PROVISION_PROFILE_BASE64": "...",
    "APPLE_KEY_CONTENT": "...",
    "P12_PASSWORD": "...",
    "APPLE_KEY_ID": "ABC1234567",
    "APPLE_ISSUER_ID": "...",
    "APP_STORE_CONNECT_TEAM_ID": "TEAM123456"
  }
}
```

## Enregistrer les identifiants Android

<Aside type="note">
**Vous n'avez pas encore de keystore ?** Consultez le [guide des builds Android](/docs/cli/cloud-build/android/#creating-a-keystore) pour obtenir des instructions sur la cr√©ation d'un keystore et la configuration des identifiants du Play Store.
</Aside>

### Exemple complet

```bash
npx @capgo/cli build credentials save \
  --platform android \
  --keystore ./release.keystore \
  --keystore-alias "my-key-alias" \
  --keystore-key-password "KeyPassword123" \
  --keystore-store-password "StorePassword123" \
  --play-config ./play-store-service-account.json
```

### Options Android

| Option | Description | Requis |
|--------|-------------|----------|
| `--keystore <path>` | Chemin vers le fichier .keystore ou .jks | Oui (release) |
| `--keystore-alias <alias>` | Alias de la cl√© dans le keystore | Oui (release) |
| `--keystore-key-password <password>` | Mot de passe de l'alias de cl√© | Oui (release) |
| `--keystore-store-password <password>` | Mot de passe du keystore | Oui (release) |
| `--play-config <path>` | Chemin vers le JSON du compte de service Play Store | Oui (soumission) |

### Ce qui est stock√©

Lorsque vous enregistrez les identifiants Android, le CLI :
1. Lit les fichiers keystore et JSON du compte de service
2. Les convertit en encodage base64
3. Enregistre les identifiants dans le dossier `.capgo-credentials`
4. Stocke les mots de passe et l'alias en texte brut (fichiers locaux uniquement)

La structure de fichier stock√©e :
```json
{
  "android": {
    "ANDROID_KEYSTORE_FILE": "...",
    "PLAY_CONFIG_JSON": "...",
    "KEYSTORE_KEY_ALIAS": "my-key-alias",
    "KEYSTORE_KEY_PASSWORD": "...",
    "KEYSTORE_STORE_PASSWORD": "..."
  }
}
}
```

## Utiliser les identifiants enregistr√©s

Une fois que vous avez enregistr√© les identifiants, ils sont automatiquement utilis√©s lors de la compilation :

```bash
# Les identifiants sont automatiquement charg√©s depuis le dossier .capgo-credentials
npx @capgo/cli build com.example.app --platform ios
```

Vous pouvez √©galement remplacer les identifiants enregistr√©s en utilisant des variables d'environnement :

```bash
# Les variables d'environnement ont priorit√© sur les identifiants enregistr√©s
BUILD_CERTIFICATE_BASE64="..." \
P12_PASSWORD="different-password" \
npx @capgo/cli build com.example.app --platform ios
```

**Ordre de priorit√© :**
1. Variables d'environnement (priorit√© la plus √©lev√©e)
2. Identifiants enregistr√©s dans le dossier `.capgo-credentials`
3. Pas d'identifiants (priorit√© la plus basse)

## Afficher les identifiants enregistr√©s

Listez les identifiants que vous avez enregistr√©s :

```bash
npx @capgo/cli build credentials list
```

Exemple de sortie :
```
üìã Identifiants de build enregistr√©s :

Identifiants iOS :
  ‚úì Certificat (base64)
  ‚úì Profil de provisionnement (base64)
  ‚úì Contenu de la cl√© Apple (base64)
  ‚úì Mot de passe P12 : ********
  ‚úì ID de cl√© Apple : ABC1234567
  ‚úì ID d'√©metteur Apple : 00000000-0000-0000-0000-000000000000
  ‚úì ID d'√©quipe : TEAM123456

Identifiants Android :
  ‚úì Keystore (base64)
  ‚úì Configuration Play Store (base64)
  ‚úì Alias du keystore : my-key-alias
  ‚úì Mot de passe de la cl√© : ********
  ‚úì Mot de passe du magasin : ********

Emplacement : .capgo-credentials/

üîí Ces identifiants sont stock√©s localement uniquement sur votre machine.
   Lors de la compilation, ils sont envoy√©s √† Capgo mais ne sont JAMAIS stock√©s l√†-bas.
   Ils sont automatiquement supprim√©s apr√®s la fin du build (max 24 heures).
```

## Meilleures pratiques de s√©curit√©

### S√©curit√© du stockage local

1. **Permissions de fichiers**
   ```bash
   # Assurez-vous que le dossier d'identifiants n'est pas accessible aux autres
   chmod 700 .capgo-credentials
   chmod 600 .capgo-credentials/*
   ```

2. **Ne jamais committer les identifiants**
   ```bash
   # Ajouter au .gitignore
   echo ".capgo-credentials/" >> .gitignore
   ```

3. **S√©parer les identifiants**
   - Utilisez des identifiants diff√©rents pour le d√©veloppement local vs CI/CD
   - Faites tourner les identifiants r√©guli√®rement
   - Ne partagez pas les identifiants entre les membres de l'√©quipe

### Utilisation CI/CD

Pour les environnements CI/CD, **pr√©f√©rez les variables d'environnement** aux identifiants enregistr√©s :

```yaml
# GitHub Actions
env:
  BUILD_CERTIFICATE_BASE64: ${{ secrets.IOS_CERTIFICATE }}
  P12_PASSWORD: ${{ secrets.P12_PASSWORD }}
  # ... autres secrets
```

C'est plus s√©curis√© car :
- Les secrets sont g√©r√©s par votre plateforme CI/CD
- Pas de fichiers d'identifiants sur les runners
- Rotation facile et contr√¥le d'acc√®s
- Pistes d'audit pour l'utilisation des secrets

### Rotation des identifiants

Faites tourner r√©guli√®rement vos identifiants :

1. **iOS** : G√©n√©rez de nouveaux certificats et cl√©s API annuellement
2. **Android** : Changez les mots de passe du keystore annuellement
3. **Apr√®s des changements d'√©quipe** : Faites tourner lorsque des membres de l'√©quipe partent

Mettre √† jour les identifiants enregistr√©s :
```bash
# R√©ex√©cutez la commande d'enregistrement avec les nouveaux identifiants
npx @capgo/cli build credentials save --platform ios --certificate ./new-cert.p12 ...
```

## D√©pannage

### "Aucun identifiant trouv√©"

Si le build indique qu'aucun identifiant n'a √©t√© trouv√© :

1. **V√©rifiez si les identifiants sont enregistr√©s** :
   ```bash
   npx @capgo/cli build credentials list
   ```

2. **Enregistrez les identifiants s'ils sont manquants** :
   ```bash
   npx @capgo/cli build credentials save --platform ios ...
   ```

3. **V√©rifiez que le dossier d'identifiants existe** :
   ```bash
   ls -la .capgo-credentials/
   ```

### "Permission refus√©e" lors de la lecture des identifiants

Corrigez les permissions de fichiers :

```bash
chmod 700 .capgo-credentials
chmod 600 .capgo-credentials/*
```

### Les identifiants ne sont pas utilis√©s

V√©rifiez que la plateforme correcte est sp√©cifi√©e :

```bash
# Assurez-vous que --platform correspond aux identifiants enregistr√©s
npx @capgo/cli build com.example.app --platform ios  # Utilise les identifiants ios
npx @capgo/cli build com.example.app --platform android  # Utilise les identifiants android
```

### Effacer et r√©enregistrer les identifiants

Si les identifiants semblent corrompus :

```bash
# Effacer tous les identifiants
npx @capgo/cli build credentials clear

# Enregistrer √† nouveau
npx @capgo/cli build credentials save --platform ios ...
```

## Migration depuis les variables d'environnement

Si vous utilisez actuellement des variables d'environnement, vous pouvez migrer vers les identifiants enregistr√©s :

<Steps>

1. **Extraire vos variables d'environnement actuelles**
   ```bash
   echo $BUILD_CERTIFICATE_BASE64  # V√©rifiez qu'elles existent
   ```

2. **D√©coder les fichiers base64 vers les fichiers d'origine** (si n√©cessaire)
   ```bash
   echo "$BUILD_CERTIFICATE_BASE64" | base64 -d > cert.p12
   echo "$BUILD_PROVISION_PROFILE_BASE64" | base64 -d > profile.mobileprovision
   ```

3. **Enregistrer en utilisant le CLI**
   ```bash
   npx @capgo/cli build credentials save \
     --platform ios \
     --certificate ./cert.p12 \
     --provisioning-profile ./profile.mobileprovision \
     --p12-password "$P12_PASSWORD" \
     --apple-key-id "$APPLE_KEY_ID" \
     --apple-issuer-id "$APPLE_ISSUER_ID" \
     --apple-team-id "$APP_STORE_CONNECT_TEAM_ID"
   ```

4. **Tester le build**
   ```bash
   npx @capgo/cli build com.example.app --platform ios
   ```

5. **Supprimer les variables d'environnement** (optionnel)
   ```bash
   unset BUILD_CERTIFICATE_BASE64 BUILD_PROVISION_PROFILE_BASE64
   ```

</Steps>

## Emplacement du fichier

Les identifiants sont stock√©s dans le dossier `.capgo-credentials` :
- **macOS/Linux** : `.capgo-credentials/` (dans la racine de votre projet ou le r√©pertoire home)
- **Windows** : `.capgo-credentials\` (dans la racine de votre projet ou le r√©pertoire home)

Le dossier est automatiquement cr√©√© lorsque vous enregistrez des identifiants pour la premi√®re fois.

## Prochaines √©tapes

- [Commencer](/docs/cli/cloud-build/getting-started/) - Cr√©er votre premier build
- [Builds iOS](/docs/cli/cloud-build/ios/) - Configuration de build sp√©cifique √† iOS
- [Builds Android](/docs/cli/cloud-build/android/) - Configuration de build sp√©cifique √† Android
- [D√©pannage](/docs/cli/cloud-build/troubleshooting/) - Probl√®mes courants et solutions

## Besoin d'aide ?

- üìö [Guide de d√©pannage](/docs/cli/cloud-build/troubleshooting/)
- üí¨ [Communaut√© Discord](https://discord.com/invite/VnYRvBfgA6)
- üìß Email : support@capgo.app
