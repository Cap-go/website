---
title: Capacitor updaterを使用したセルフホストCapgo
description: 캡고를 자체 호스팅하여 capacitor updater를 사용하는 방법
sidebar:
  order: 4
locale: ko
---

## 이 튜토리얼에서 다룰 내용은?

이 튜토리얼에서는 셀프 호스팅된 capgo와 함께 개발 환경에서 capacitor updater를 사용하는 방법을 보여줄 것입니다.

## 요구사항

1. [Capgo 클론](https://githubcom/Cap-go/capgo)

## 시작하기

셀프 호스팅된 capgo와 함께 capacitor updater를 사용하려면 앱 디렉토리의 `capacitorconfigts`를 다음과 같이 수정하세요:

```ts
const config: CapacitorConfig = {
  appId: 'comdemoapp',
  appName: 'demoApp',
  webDir: 'dist',
  bundledWebRuntime: false,
  plugins: {
    CapacitorUpdater : {
      statsUrl: "http://localhost:54321/functions/v1/stats",
      channelUrl: "http://localhost:54321/functions/v1/channel_self",
      updateUrl: "http://localhost:54321/functions/v1/updates"
    },
  },
};
```

이렇게 하면 개발 환경에서 로컬 capgo를 사용할 수 있지만, 기본적으로 이것만으로는 충분하지 않습니다.

Android에서는 기본적으로 SSL이 로컬에서 비활성화되어 있으므로 [일반 텍스트 통신](https://developerandroidcom/topic/security/risks/cleartext)을 활성화해야 합니다.
이는 [AndroidManifestxml](https://githubcom/Cap-go/capacitor-updater/blob/main/android/src/main/AndroidManifestxml)을 수정하고 `application` 태그에 `android:usesCleartextTraffic="true"`를 추가하여 달성할 수 있습니다.
이 변경의 전체 예시는 [여기](https://gistgithubcom/WcaleNieWolny/061a015acdebe35eaf3afd7030797701)에서 확인할 수 있습니다.

Android는 기본적으로 `http`를 허용하지 않기 때문에 capgo는 [여기](https://githubcom/Cap-go/capgo/blob/4cce6c0707d745faa2afbab643e636bad927c602/supabase/functions/updates/indexts#L396)에서 http를 확인하도록 구현했습니다.
이 코드가 항상 여기 있지는 않을 수 있지만, 현재로서는 업데이트가 작동하도록 하려면 이 라인을 변경해야 합니다.
이 라인은 다음과 같아야 합니다:
```ts
    if (!signedURL || (signedURLstartsWith('http://') || signedURLstartsWith('https://'))) {
```

:::danger
⚠️ `supabase/functions/updates/indexts`를 원격 저장소에 커밋하지 마세요\
이 코드는 [의도적으로](https://githubcom/Cap-go/capacitor-updater/issues/37#issuecomment-1684916354) 여기에 있습니다
:::

android 앱이 연결되는 것을 막는 문제가 있을 수 있습니다. edge 함수로 전송되는 요청이 보이지 않는다면 다음을 실행하세요:
```bash
adb reverse tcp:54321 tcp:54321
```