---
title: ロールバック
sidebar:
  order: 5
locale: ja
---

import { Aside, Steps } from '@astrojs/starlight/components';

Capgoのライブアップデートはユーザーに迅速な改善と修正を提供できますが、アプリの以前のバージョンにロールバックする必要がある状況もあります。新しいアップデートで予期せぬ重大な問題が発生した場合や、修正作業中に特定の変更を元に戻したい場合などです。

Capgoはチャンネルのビルドを管理し、ユーザーが受け取るアプリのバージョンを制御するための複数の方法を提供しています。

## 以前のバンドルへのロールバック

新しいビルドをアップロードしチャンネルに割り当てるたびに、Capgoはそれらのビルドの履歴を保持します。特定のアップデートを元に戻す必要がある場合、これらの以前のビルドの1つを選択してチャンネルに再デプロイできます。

以前のビルドにロールバックするには：

<Steps>

1. [Capgoダッシュボード](https://app.capgo.io)にログインします

2. 「Channels」セクションに移動します

3. ロールバックしたいチャンネルの名前をクリックします

4. チャンネルのビルド履歴から元に戻したいビルドを見つけます

5. そのビルドの横にあるクラウンアイコンをクリックして、チャンネルのアクティブビルドにします
   ![チャンネル管理オプション](/select_bundle.webp)

6. このビルドにロールバックすることを確認します

</Steps>

<Aside type="note">
以前のビルドへのロールバックは、選択したチャンネルにのみ影響します。複数のチャンネル（例：本番環境、ステージング環境など）がある場合、影響を受ける各チャンネルでロールバックプロセスを繰り返す必要があります。
</Aside>

ロールバック後、更新されたチャンネルをリッスンするように設定されたデバイスは、次回のアップデートチェック時に以前のビルドを受け取ります。ロールバックされたビルドは新しいアップデートとして扱われるため、通常のアップデートフローと条件が適用されます。

## チャンネルのリンク解除

問題を調査している間、チャンネルのアップデートを一時的に停止したい場合は、チャンネルを現在のビルドからリンク解除できます。

チャンネルをリンク解除するには：

1. Capgoダッシュボードでチャンネルに移動します

2. 現在のビルドの横にある「Unlink」ボタンをクリックします

3. チャンネルのリンクを解除することを確認します

チャンネルがリンク解除されると、新しいアップデートは配信されなくなります。そのチャンネルに設定されたデバイスは、チャンネルが再びビルドにリンクされるまで現在のビルドのままとなります。

これは、アップデートに問題を特定したものの、どのビルドにロールバックするか確信が持てない場合に便利です。チャンネルをリンク解除することで、さらなるアップデートを配信することなく調査する時間を確保できます。

## ビルトインバンドルの強制

より深刻な状況では、チャンネル上のすべてのデバイスをアプリのネイティブバイナリに最初からパッケージされていたウェブビルドに戻したい場合があります。これは「ビルトインバンドル」として知られています。

チャンネルでビルトインバンドルを強制するには：

1. Capgoダッシュボードでチャンネルに移動します

2. 「Built-in Bundle」ボタンをクリックします

3. ビルトインバンドルを強制することを確認します

ビルトインバンドルを強制すると、そのチャンネルに設定されているすべてのデバイスは、次回のアップデートチェック時に元のパッケージされたウェブビルドに戻ります。これは現在のビルドに関係なく発生します。

これは特定の以前のビルドに戻すよりも積極的なロールバックオプションで、アプリがアプリストアに最後に公開されて以降にリリースされたすべてのライブアップデートが破棄されます。

<Aside type="caution">
ビルトインバンドルの強制は、チャンネル上のすべてのデバイスに影響を与えるため注意が必要です。この操作を行う前に、影響を考慮し、前進するための計画を立ててください。
</Aside>

## 問題のモニタリングと対応

問題をすばやく発見し、問題のあるアップデートの影響を最小限に抑えるためには、リリースのモニタリングと問題への対応計画を立てることが重要です。

いくつかの戦略には以下が含まれます：

- アップデートのリリース直後のクラッシュレポートとユーザーフィードバックのモニタリング
- 段階的なロールアウトやステージドチャンネルシステムを使用して、広範なリリース前に小規模なグループでアップデートをテスト
- ロールバック、リンク解除、またはビルトインバンドルの強制をいつ行うか、誰に権限があるかについての明確な決定プロセスの確立
- 適切な場合、問題と解決策についてユーザーへの通知

慎重なモニタリングと問題のあるアップデートを迅速に管理する能力を組み合わせることで、ユーザーへの混乱を最小限に抑えながら、継続的に改善するアプリ体験を提供できます。