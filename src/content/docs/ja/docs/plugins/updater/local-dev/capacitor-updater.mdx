---
title: "セルフホスティングcapgoでcapacitor updaterを使用する"
locale: ja
description: "セルフホスティングのCapgoでcapacitor updaterを使用する方法。Capgoの独自インスタンスで完全に自律的になります"
sidebar:
    order: 4
---

## このチュートリアルで何をカバーしますか？

このチュートリアルでは、セルフホスティングcapgoを使用した開発環境でcapacitor updaterを使用する方法を説明します

## 要件

 1. [capgoをクローン](https://github.com/Cap-go/capgo)

## はじめに

セルフホスティングcapgoでcapacitor updaterを使用するには、アプリディレクトリから`capacitor.config.ts`を編集し、次のように設定します:

```ts
const config: CapacitorConfig = {
  appId: 'com.demo.app',
  appName: 'demoApp',
  webDir: 'dist',
  bundledWebRuntime: false,
  plugins: {
    CapacitorUpdater : {
      statsUrl: "https://localhost:54321/functions/v1/stats",
      channelUrl: "https://localhost:54321/functions/v1/channel_self",
      updateUrl: "https://localhost:54321/functions/v1/updates"
    },
  },
};
```

これにより、開発環境でローカルcapgoを使用できるようになります。ただし、デフォルトではこれだけでは不十分です。

> デフォルトでは、iOSとAndroidの両方でHTTPSの使用が期待されます。Ngrokやlocalcanなどのツールを使用して、APIをhttpsでプロキシする必要があります。

Androidには[平文通信](https://developer.android.com/topic/security/risks/cleartext)を有効にする方法があります。
これは[AndroidManifest.xml](https://github.com/Cap-go/capacitor-updater/blob/main/android/src/main/AndroidManifest.xml)を変更し、`application`タグに`android:usesCleartextTraffic="true"`を追加することで実現できます
この変更の完全な例は[こちら](https://gist.github.com/WcaleNieWolny/061a015acdebe35eaf3afd7030797701)で確認できます

Androidアプリの接続を妨げる問題が発生する可能性もあります。edge functionsに送信されるリクエストが表示されない場合は、以下を実行してください
```bash
adb reverse tcp:54321 tcp:54321
```
