---
title: "ログ"
description: "Capgoのアプリケーションログを理解し、デバイスのアップデートアクションの診断と追跡に活用する"
sidebar:
  order: 8
locale: ja
---

## アプリケーションログの理解

ログページは、アプリケーションのアップデートイベントと診断情報の詳細な履歴を提供します。これは、アップデートプロセスの監視、問題のトラブルシューティング、デバイスがCapgoとどのようにやり取りしているかを理解するために重要です。[アプリをクリック](/docs/webapp/main-page)してから[「ログ」タブをクリック（古いスクリーンショットやドキュメントでは以前「更新」と呼ばれていました）](/docs/webapp/main-app-page)することでアクセスできます。

そこから、ログエントリのリストを表示するこのようなページが表示されます：

<figure><img style="margin-left: auto; margin-right: auto" src="/logs.webp" alt="メインインターフェースを示すログページの概要" /><figcaption>ログページの概要</figcaption></figure>

ログページのインターフェースには以下が含まれます：
1. **ログタブ** - ログビューにアクセスするためのナビゲーションタブ
2. **リロードボタン** - 最新のデータでログリストを更新
3. **時間範囲とアクションフィルター** - 日付範囲とアクションタイプでログをフィルタリング（以下のセクションを参照）

各行には以下が表示されます：
- **タイムスタンプ**（UTC）
- **デバイスID**
- **アクションコード**（何が起こったか）
- **バージョン名**（バンドルまたは`builtin`）

行をクリックすると、完全な履歴が表示されるデバイス詳細ページにジャンプします。

### 日付範囲でフィルタリング

日付ピッカーを使用して、特定の期間でログをフィルタリングできます：

<figure><img style="margin-left: auto; margin-right: auto" src="/logs_date_range.webp" alt="ログをフィルタリングするための日付範囲ピッカー" /><figcaption>日付範囲フィルター</figcaption></figure>

1. **クイックプリセット** - 一般的な時間範囲を選択：過去1時間、3時間、6時間、または12時間
2. **開始時刻** - 範囲のカスタム開始時刻を設定
3. **終了時刻** - 範囲のカスタム終了時刻を設定
4. **カレンダー** - カレンダービューを使用して特定の日付を選択

「選択」をクリックして選択した日付範囲を適用するか、「キャンセル」をクリックしてピッカーを閉じます。

### アクションタイプでフィルタリング

アクションドロップダウンを使用すると、特定のイベントタイプでログをフィルタリングできます：

<figure><img style="margin-left: auto; margin-right: auto" src="/logs_filters.webp" alt="イベントタイプでログをフィルタリングするためのアクションフィルタードロップダウン" /><figcaption>アクションフィルター</figcaption></figure>

利用可能なアクションフィルターには以下が含まれます：
- **デバイスハートビート** - デバイスからの定期的なヘルスチェック
- **バージョン削除リクエスト** - バンドルバージョンが削除されたとき
- **デフォルトバージョンにリセット** - デバイスが組み込みバンドルに戻ったとき
- **バージョンが正常にインストールされました** - バンドルのインストール成功
- **新しいバージョンがデバイスに送信されました** - Capgoがデバイスにアップデートを送信したとき
- **バージョンのインストールに失敗しました** - バンドルのインストールが失敗したとき

上部の検索ボックスを使用して、特定のアクションタイプをすばやく見つけます。複数のアクションを選択して、選択したタイプのいずれかに一致するログを表示できます。

### サンプルログスニペット（ダミーデータ）

| 時刻 (UTC) | デバイスID | アクション | バージョン | 意味 |
|------------|-----------|----------|----------|------|
| 2025-01-14 10:00:01 | `A1B2C3` | `get` | 2.4.1 | デバイスがCapgoにアップデートが利用可能か問い合わせた |
| 2025-01-14 10:00:03 | `A1B2C3` | `download_manifest_start` | 2.4.1 | マニフェストのダウンロードが開始された；SDKがファイルをダウンロードしようとしている |
| 2025-01-14 10:00:07 | `A1B2C3` | `download_40` | 2.4.1 | バンドルのダウンロードが40%完了 |
| 2025-01-14 10:00:12 | `A1B2C3` | `download_zip_complete` | 2.4.1 | zipのダウンロードが完了 |
| 2025-01-14 10:00:13 | `A1B2C3` | `set` | 2.4.1 | バンドルがインストールされ、次回の実行用にマークされた |
| 2025-01-14 10:05:00 | `B9C8D7` | `disableAutoUpdateToMajor` | 1.9.0 | チャネルポリシーが2.xへのジャンプをブロックした |
| 2025-01-14 10:05:05 | `B9C8D7` | `rateLimited` | builtin | デバイスがリクエスト制限に達した；SDKは再起動まで待機 |

## ログシナリオの例

ログが何を伝えているかを理解するために、実際のデバイスアップデートの流れを示すサンプルシーケンスを以下に示します：

### 成功したアップデートフロー

これは、ログで健全なアップデートがどのように見えるかです：

| 時刻 | デバイスID | アクション | バージョン | 意味 |
|------|-----------|----------|----------|------|
| 10:00:01 | `a1b2c3d4` | `get` | 1.2.0 | デバイスがアップデートをチェックし、バージョン1.2.0の情報を受信 |
| 10:00:02 | `a1b2c3d4` | `download_10` | 1.2.0 | ダウンロード開始、10%完了 |
| 10:00:03 | `a1b2c3d4` | `download_50` | 1.2.0 | ダウンロード50% |
| 10:00:05 | `a1b2c3d4` | `download_complete` | 1.2.0 | ダウンロードが正常に完了 |
| 10:00:06 | `a1b2c3d4` | `set` | 1.2.0 | バンドルがインストールされ、アクティブ化された |

### デバイスはすでに最新

デバイスがチェックしたが、すでに最新バージョンを持っている場合：

| 時刻 | デバイスID | アクション | バージョン | 意味 |
|------|-----------|----------|----------|------|
| 14:30:00 | `e5f6g7h8` | `noNew` | 1.2.0 | デバイスはすでに最新バージョン、アップデート不要 |

### ロールバック付きの失敗したアップデート

アップデートが失敗し、デバイスがロールバックした場合：

| 時刻 | デバイスID | アクション | バージョン | 意味 |
|------|-----------|----------|----------|------|
| 11:15:00 | `i9j0k1l2` | `get` | 1.3.0 | デバイスがアップデート情報を受信 |
| 11:15:02 | `i9j0k1l2` | `download_complete` | 1.3.0 | ダウンロード完了 |
| 11:15:03 | `i9j0k1l2` | `set` | 1.3.0 | バンドルが設定された |
| 11:15:10 | `i9j0k1l2` | `update_fail` | 1.3.0 | アプリがクラッシュしたか、`notifyAppReady()`が呼び出されなかった - ロールバックが発動 |
| 11:15:11 | `i9j0k1l2` | `reset` | builtin | デバイスが組み込みバージョンに戻った |

**必要なアクション**：アプリが初期化成功後に`notifyAppReady()`を呼び出していることを確認してください。詳細は[プラグインドキュメント](/docs/plugin/api/#notifyappready)を参照してください。

### ダウンロード失敗

ネットワークの問題がダウンロードを妨げた場合：

| 時刻 | デバイスID | アクション | バージョン | 意味 |
|------|-----------|----------|----------|------|
| 09:45:00 | `m3n4o5p6` | `get` | 1.2.0 | デバイスがアップデート情報を受信 |
| 09:45:01 | `m3n4o5p6` | `download_30` | 1.2.0 | ダウンロード開始したが... |
| 09:45:15 | `m3n4o5p6` | `download_fail` | 1.2.0 | ダウンロード失敗（ネットワークタイムアウト、接続喪失など） |

**必要なアクション**：デバイスは次回のアプリ起動時に自動的に再試行します。これが頻繁に発生しない限り、アクションは不要です。

### プラン制限に到達

アカウントがデバイス制限に達した場合：

| 時刻 | デバイスID | アクション | バージョン | 意味 |
|------|-----------|----------|----------|------|
| 16:00:00 | `q7r8s9t0` | `needPlanUpgrade` | - | このデバイスは、アップグレードするか請求サイクルがリセットされるまでアップデートを受信しません |

**必要なアクション**：[プランをアップグレード](/docs/webapp/settings/)するか、次の請求サイクルを待ってください。

### チャネル設定がアップデートをブロック

チャネル設定がアップデートを妨げている場合：

| 時刻 | デバイスID | アクション | バージョン | 意味 |
|------|-----------|----------|----------|------|
| 12:00:00 | `u1v2w3x4` | `disableAutoUpdateToMajor` | 2.0.0 | v1.xのデバイスはv2.xに自動アップデートできない（メジャーバージョンジャンプがブロック） |
| 12:05:00 | `y5z6a7b8` | `disableEmulator` | 1.2.0 | エミュレータが検出され、チャネルがエミュレータをブロック |
| 12:10:00 | `c9d0e1f2` | `disableDevBuild` | 1.2.0 | 開発ビルドが検出され、チャネルが開発ビルドをブロック |

**必要なアクション**：これらは意図的な保護です。これらのアップデートを許可したい場合は、[チャネル設定](/docs/webapp/channels/)を変更してください。

## ログコード（Capgoバックエンドenum）

これらのコードは、ダッシュボードAPIで使用される`stats_action` enumから来ています（`capgo/src/types/supabase.types.ts`）。UIで新しいコードを見た場合、それはSDKまたはバックエンドによって発行され、このリストに対して検証されました。

**ハッピーパスとライフサイクル**

| コード | 意味 |
|--------|------|
| `get` | デバイスがCapgoに現在のチャネルマニフェストを問い合わせた |
| `download_manifest_start`, `download_manifest_complete` | マニフェストのダウンロード開始/完了（デルタまたはマルチファイルバンドル用） |
| `download_zip_start`, `download_zip_complete` | zipアーカイブのダウンロード開始/完了 |
| `download_10` … `download_90` | ダウンロード進捗のマイルストーン |
| `download_complete` | バンドル全体がダウンロードされた |
| `set` | バンドルが次回起動用にステージングされた |
| `reset` | デバイスが組み込みバンドルに戻った |
| `delete` | バンドルがローカルストレージから削除された |
| `uninstall` | アプリのアンインストールが検出された |
| `app_moved_to_foreground`, `app_moved_to_background` | SDKによって記録されたアプリライフサイクルイベント |
| `ping` | デバイスからのヘルス/ハートビートチェック |
| `setChannel`, `getChannel` | SDK呼び出し経由でチャネルがオーバーライドまたは取得された |

**設定またはポリシーブロック**

| コード | アップデートがブロックされた理由 |
|--------|-------------------------------|
| `disableAutoUpdate`, `disableAutoUpdateToMajor`, `disableAutoUpdateToMinor`, `disableAutoUpdateToPatch`, `disableAutoUpdateMetadata`, `disableAutoUpdateUnderNative` | チャネル戦略がこのsemverジャンプを禁止 |
| `disablePlatformIos`, `disablePlatformAndroid` | プラットフォームがチャネルで無効化されている |
| `disableDevBuild`, `disableEmulator` | 開発ビルドまたはエミュレータが許可されていない |
| `cannotUpdateViaPrivateChannel`, `NoChannelOrOverride`, `channelMisconfigured` | チャネル選択またはオーバーライドが失敗 |
| `missingBundle`, `cannotGetBundle` | マニフェストがCapgoが提供できないバンドルを参照している |
| `needPlanUpgrade` | 組織がプラン/デバイス制限に達した |
| `rateLimited` | リクエストが多すぎる；SDKが再起動までスロットル |
| `blocked_by_server_url`, `backend_refusal`, `InvalidIp` | サーバー側のルールがリクエストをブロック |

**ダウンロード/整合性/インストール失敗**

| コード | 意味 |
|--------|------|
| `download_fail` | バンドルのダウンロードが失敗（ネットワークまたはレスポンスエラー） |
| `download_manifest_file_fail`, `download_manifest_checksum_fail`, `download_manifest_brotli_fail` | マニフェストファイルを取得または検証できなかった |
| `checksum_fail`, `checksum_required` | 整合性チェックが失敗またはチェックサムが欠落 |
| `unzip_fail`, `directory_path_fail`, `canonical_path_fail`, `windows_path_fail` | ファイルシステムまたは解凍の検証が失敗 |
| `decrypt_fail` | 復号化が失敗（暗号化されたバンドル） |
| `update_fail` | バンドルはインストールされたがアプリが`notifyAppReady()`を呼び出さなかった；ロールバックが発動 |
| `download_zip_*`の後に`set`がない | ダウンロードは完了したがインストールフェーズが完了しなかった |

➡️ コードごとのより詳細なガイダンスが必要ですか？**[完全なログコードリファレンスとデバッグガイド](/docs/plugins/updater/debugging/#understanding-cloud-logs)**を参照してください。

## ログの詳細を取得する

特定のログエントリをクリックすると、通常は[デバイスページ](/docs/webapp/devices/)に移動します。これにより、その特定のデバイスの完全な履歴を見ることができ、デバイス固有の問題を診断したり、アップデートの流れを理解するのに非常に役立ちます。
