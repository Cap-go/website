---
title: トラブルシューティング
sidebar:
  order: 5
next: false
prev: false
locale: ja
---

Capgo の使用中によくある問題と解決方法をご紹介します

### アップロードの失敗

バンドルのアップロードが失敗する場合は、以下をご確認ください:
- `capacitor.config.ts` のアプリ ID が Capgo ダッシュボードのアプリと一致していること
- Capacitor プロジェクトのルートからアップロードコマンドを実行していること
- Web アセットがビルドされ最新の状態であること

#### 高度なアップロードオプション

Capgo CLI には、一般的なアップロードの問題に対応するための追加フラグがあります:

- `--tus`: 大きなバンドルや不安定なネットワーク接続での信頼性の高いアップロードのための [tus レジュームアップロードプロトコル](https://tus.io/) を使用します。バンドルが 10MB を超える場合や接続が不安定な場合は、`--tus` の使用を検討してください:
  ```shell
  npx @capgo/cli@latest upload --tus
  ```

- `--package-json` と `--node-modules`: モノレポや npm ワークスペースなどの非標準の構造を使用している場合、ルートの `package.json` と `node_modules` の場所を Capgo に指示します。ルートの `package.json` へのパスと `--node_modules` パスを指定します:
  ```shell
  npx @capgo/cli@latest upload --package-json=path/to/package.json --node_modules=path/to/node_modules
  ```
  Capgo はアプリの依存関係を正しくバンドルするためにこの情報を必要とします

これらのフラグは `--channel` などの他のオプションと組み合わせることができます。利用可能なアップロードオプションの詳細については [Capgo CLI ドキュメント](/docs/cli) をご覧ください

アップロードでまだ問題が発生する場合は、[Capgo サポート](mailto:support@capgo.app) までお問い合わせください

### アップデートのデバッグ

ライブアップデートで問題が発生した場合、Capgo のデバッグコマンドがトラブルシューティングに役立ちます。使用方法:

1 プロジェクトディレクトリで以下のコマンドを実行します:
   ```shell
   npx @capgo/cli@latest app debug
   ```

2 デバイスまたはエミュレータでアプリを起動し、アップデートをトリガーするアクション (新しいバンドルをアップロードした後にアプリを再起動するなど) を実行します

3 デバッグコマンドの出力を監視します。アップデートプロセスに関する以下の情報が記録されます:
   - アプリがアップデートをチェックするタイミング
   - アップデートが見つかった場合とそのバージョン
   - アップデートのダウンロードとインストールの進行状況
   - アップデートプロセス中に発生したエラー

4 デバッグログを使用して問題の発生場所を特定します。例えば:
   - アップデートが見つからない場合は、バンドルが正常にアップロードされ、アプリが正しいチャンネルを使用するように設定されているか確認します
   - アップデートはダウンロードされるがインストールされない場合は、`CapacitorUpdater.notifyAppReady()` が呼び出されており、アプリが完全に終了して再起動されたことを確認します
   - エラーメッセージが表示される場合は、Capgo のドキュメントでそのエラーを確認するか、サポートにお問い合わせください

デバッグコマンドは、アップデートのダウンロードとインストールプロセスの問題を特定するのに特に役立ちます。ログに期待されるアップデートバージョンが見つかったが最終的に適用されなかった場合は、ダウンロード後の手順にトラブルシューティングの焦点を当ててください

### ネイティブログによるデバッグ

Capgo デバッグコマンドに加えて、Android と iOS のネイティブログは、特にアップデートプロセスのネイティブ側での問題に関する貴重なトラブルシューティング情報を提供できます

#### Android のログ

Android のログにアクセスするには:

1 デバイスを接続するか、エミュレータを起動します
2 Android Studio を開き、"View > Tool Windows > Logcat" を選択します
3 Logcat ウィンドウで、上部のドロップダウンからアプリのプロセスを選択してログをフィルタリングします
4 `Capgo` を含む行を探してSDKのログを確認します

または、`adb logcat` コマンドを使用し、`Capgo` で grep してログをフィルタリングすることもできます

Capgo SDK は以下のような重要なイベントを記録します:
- アップデートチェックが開始されたとき
- アップデートが見つかった場合とそのバージョン
- アップデートのダウンロードが開始され完了したとき
- アップデートのインストールがトリガーされたとき
- ネイティブアップデート手順中に発生したエラー

ログに表示される可能性のある Android 固有の問題には以下があります:
- アップデートのダウンロードを妨げるネットワーク接続の問題
- アップデートバンドルの保存または読み取り時のファイル権限エラー
- アップデートバンドル用のストレージ容量不足
- アップデートのインストール後にアプリを再起動できない

#### iOS のログ

iOS のログにアクセスするには:

1 デバイスを接続するか、シミュレータを起動します
2 Xcode を開き、"Window > Devices and Simulators" に移動します
3 デバイスを選択し、"Open Console" をクリックします
4 コンソール出力で `Capgo` を含む行を探してSDKのログを確認します

ターミナルで `log stream` コマンドを使用し、`Capgo` で grep してログをフィルタリングすることもできます

Android と同様に、Capgo SDK は以下のような iOS 側のイベントを記録します:
- アップデートチェックの開始と結果
- ダウンロードの開始、進行状況、完了
- インストールのトリガーと結果
- ネイティブアップデートプロセス中のエラー

ログで特定できる iOS 固有の問題には以下があります:
- アップデートのダウンロード時の SSL 証明書の問題
- アップデートのダウンロードをブロックするアプリトランスポートセキュリティ
- アップデートバンドル用のストレージ容量不足
- アップデートバンドルの正しい展開または適用の失敗

両プラットフォームで、ネイティブログはアップデートプロセスのより低レベルのビューを提供し、ネイティブ実装に関するより詳細な情報を提供します。これらは特に Capgo JavaScript レイヤーの外部で発生する問題を特定するのに役立ちます

複雑なライブアップデートの問題をトラブルシューティングする場合は、Capgo デバッグログとネイティブログの両方を取得して包括的な状況把握をすることをお勧めします。2つのログを合わせることで、問題を特定して解決する最善のチャンスが得られます

### アップデートが適用されない

バンドルをアップロードしたのにデバイスに変更が表示されない場合:
- [クイックスタート](/docs/getting-started/quickstart) に示されているように、アプリコードで `CapacitorUpdater.notifyAppReady()` を呼び出していることを確認します
- デバイスがインターネットに接続されており、Capgo デバッグログにアップデートがダウンロードされたことが表示されているか確認します
- アプリを完全に終了して再起動してみてください。アップデートは新しい起動時にのみ適用されます
- アップデートの適用に問題がある可能性を示すネイティブログのエラーを確認します

アップデートプロセスの詳細については、[ライブアップデートのデプロイ](/docs/getting-started/deploy) ガイドを参照してください。まだ問題が解決しない場合は、`npx @capgo/cli@latest app debug` コマンドとネイティブログを使用して、何が起こっているのかをより詳しく確認してください

## SDK のインストール

Capgo SDK のインストールで問題が発生した場合は、以下を確認してください:
- アプリが対応バージョンの Capacitor (4.0 以降) を使用していること
- SDK のインストール後にアプリを同期することを含め、[クイックスタート](/docs/getting-started/quickstart) の手順を順番に実行していること

## CI/CD 統合

CI/CD パイプラインからの Capgo アップロードのトリガーに関する問題の場合:
- Capgo 認証トークンが正しく設定されているか確認します
- Web アセットがビルドされた後にアップロードコマンドを実行していることを確認します
- アップロードコマンドがターゲット環境に対して正しいチャンネル名を使用していることを確認します

その他のトラブルシューティングのヒントについては [CI/CD 統合](/docs/cicd-integration) のドキュメントを参照してください。また、`npx @capgo/cli@latest app debug` コマンドを使用して、CI/CD でトリガーされたアップデートがアプリに受信されているか確認することもできます