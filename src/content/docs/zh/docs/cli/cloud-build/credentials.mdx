---
title: ç®¡ç†å‡­è¯
description: ä¸º iOS å’Œ Android æ„å»ºåœ¨æœ¬åœ°ä¿å­˜å’Œç®¡ç†æ„å»ºå‡­è¯
locale: zh
sidebar:
  order: 5
---

import { Steps, Aside } from '@astrojs/starlight/components';

åœ¨æœ¬åœ°ç®¡ç†æ‚¨çš„ iOS å’Œ Android æ„å»ºå‡­è¯ä»¥æ–¹ä¾¿äº‘æ„å»ºã€‚

## æ¦‚è¿°

Capgo CLI å…è®¸æ‚¨åœ¨ `.capgo-credentials` æ–‡ä»¶å¤¹ä¸­æœ¬åœ°ä¿å­˜æ„å»ºå‡­è¯ã€‚å½“æ‚¨è¿è¡Œæ„å»ºæ—¶,è¿™äº›å‡­è¯ä¼šè‡ªåŠ¨ä½¿ç”¨å¹¶å®‰å…¨åœ°å‘é€åˆ° Capgo çš„æ„å»ºæœåŠ¡å™¨ã€‚

<Aside type="tip" title="éœ€è¦å¸®åŠ©è·å–å‡­è¯?">
å¦‚æœæ‚¨è¿˜æ²¡æœ‰è¯ä¹¦å’Œå‡­è¯,è¯·æŸ¥çœ‹è¿™äº›ç»¼åˆæŒ‡å—:

**iOS:**
- [å¦‚ä½•è·å– iOS è¯ä¹¦](/docs/cli/cloud-build/ios/#how-to-get-ios-certificates-and-provisioning-profiles) - åˆ†æ­¥æŒ‡å—
- [iOS è¯ä¹¦æŒ‡å— (Capgo)](https://capgo.app/cloud/native-builds/certificates/ios/) - å¸¦æˆªå›¾çš„è¯¦ç»†æ•™ç¨‹
- [åšå®¢: è‡ªåŠ¨ iOS æ„å»º](https://capgo.app/blog/automatic-capacitor-ios-build-github-action/) - å®Œæ•´çš„ CI/CD è®¾ç½®

**Android:**
- [åˆ›å»ºå¯†é’¥åº“](/docs/cli/cloud-build/android/#creating-a-keystore) - åˆ†æ­¥æŒ‡å—
- [Android è¯ä¹¦æŒ‡å— (Capgo)](https://capgo.app/cloud/native-builds/certificates/android/) - å¸¦æˆªå›¾çš„è¯¦ç»†æ•™ç¨‹
- [åšå®¢: è‡ªåŠ¨ Android æ„å»º](https://capgo.app/blog/automatic-capacitor-android-build-github-action/) - å®Œæ•´çš„ CI/CD è®¾ç½®
</Aside>

<Aside type="caution" title="å®‰å…¨ä¿è¯">
**æ‚¨çš„å‡­è¯æ°¸è¿œä¸ä¼šæ°¸ä¹…å­˜å‚¨åœ¨ Capgo æœåŠ¡å™¨ä¸Š:**
- âœ… ä»…åœ¨æ´»åŠ¨æ„å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨
- âœ… æ„å»ºå®Œæˆåè‡ªåŠ¨åˆ é™¤
- âœ… æœ€é•¿ä¿ç•™æ—¶é—´: 24å°æ—¶(å³ä½¿æ„å»ºå¤±è´¥)
- âœ… åº”ç”¨ç›´æ¥å‘é€åˆ° App Store/Play Store - æˆ‘ä»¬ä¸å­˜å‚¨ä»»ä½•å†…å®¹
- âœ… é€šè¿‡ HTTPS å®‰å…¨ä¼ è¾“
</Aside>

## å‘½ä»¤

### ä¿å­˜å‡­è¯

æœ¬åœ°å­˜å‚¨æ‚¨çš„æ„å»ºå‡­è¯ä»¥è‡ªåŠ¨ä½¿ç”¨:

```bash
npx @capgo/cli build credentials save --platform <ios|android> [options]
```

### åˆ—å‡ºå‡­è¯

æŸ¥çœ‹å½“å‰ä¿å­˜çš„å‡­è¯(å¯†ç å·²å±è”½):

```bash
npx @capgo/cli build credentials list
```

### æ¸…é™¤å‡­è¯

ä»æœ¬åœ°æœºå™¨åˆ é™¤å·²ä¿å­˜çš„å‡­è¯:

```bash
# æ¸…é™¤æ‰€æœ‰å‡­è¯
npx @capgo/cli build credentials clear

# ä»…æ¸…é™¤ iOS å‡­è¯
npx @capgo/cli build credentials clear --platform ios

# ä»…æ¸…é™¤ Android å‡­è¯
npx @capgo/cli build credentials clear --platform android
```

## ä¿å­˜ iOS å‡­è¯

<Aside type="note">
**è¿˜æ²¡æœ‰ iOS è¯ä¹¦?** è¯·å‚é˜… [iOS æ„å»ºæŒ‡å—](/docs/cli/cloud-build/ios/#how-to-get-ios-certificates-and-provisioning-profiles) äº†è§£å¦‚ä½•åˆ›å»ºè¯ä¹¦å’Œé…ç½®æ–‡ä»¶çš„è¯´æ˜ã€‚
</Aside>

### å®Œæ•´ç¤ºä¾‹

```bash
npx @capgo/cli build credentials save \
  --platform ios \
  --certificate ./cert.p12 \
  --p12-password "YourP12Password" \
  --provisioning-profile ./profile.mobileprovision \
  --apple-key ./AuthKey_ABC1234567.p8 \
  --apple-key-id "ABC1234567" \
  --apple-issuer-id "00000000-0000-0000-0000-000000000000" \
  --apple-team-id "TEAM123456"
```

### iOS é€‰é¡¹

| é€‰é¡¹ | æè¿° | å¿…éœ€ |
|--------|-------------|----------|
| `--certificate <path>` | .p12 è¯ä¹¦æ–‡ä»¶çš„è·¯å¾„ | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--p12-password <password>` | .p12 è¯ä¹¦çš„å¯†ç  | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--provisioning-profile <path>` | .mobileprovision æ–‡ä»¶çš„è·¯å¾„ | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--provisioning-profile-prod <path>` | ç”Ÿäº§é…ç½®æ–‡ä»¶(å¯é€‰) | å¦ |
| `--apple-key <path>` | App Store Connect API .p8 å¯†é’¥çš„è·¯å¾„ | æ˜¯(æäº¤) |
| `--apple-key-id <id>` | App Store Connect API å¯†é’¥ ID | æ˜¯(æäº¤) |
| `--apple-issuer-id <id>` | App Store Connect API å‘è¡Œè€… ID (UUID) | æ˜¯(æäº¤) |
| `--apple-team-id <id>` | App Store Connect å›¢é˜Ÿ ID | æ˜¯(æäº¤) |
| `--apple-id <email>` | Apple ID ç”µå­é‚®ä»¶(æ›¿ä»£è®¤è¯) | å¦ |
| `--apple-app-password <password>` | åº”ç”¨ä¸“ç”¨å¯†ç (æ›¿ä»£è®¤è¯) | å¦ |

### å­˜å‚¨çš„å†…å®¹

å½“æ‚¨ä¿å­˜ iOS å‡­è¯æ—¶,CLI ä¼š:
1. è¯»å–è¯ä¹¦å’Œé…ç½®æ–‡ä»¶æ–‡ä»¶
2. å°†å®ƒä»¬è½¬æ¢ä¸º base64 ç¼–ç 
3. å°†å‡­è¯ä¿å­˜åˆ° `.capgo-credentials` æ–‡ä»¶å¤¹
4. å°†å¯†ç å’Œ ID å­˜å‚¨ä¸ºçº¯æ–‡æœ¬(ä»…é™æœ¬åœ°æ–‡ä»¶)

å­˜å‚¨çš„æ–‡ä»¶ç»“æ„:
```json
{
  "ios": {
    "BUILD_CERTIFICATE_BASE64": "...",
    "BUILD_PROVISION_PROFILE_BASE64": "...",
    "APPLE_KEY_CONTENT": "...",
    "P12_PASSWORD": "...",
    "APPLE_KEY_ID": "ABC1234567",
    "APPLE_ISSUER_ID": "...",
    "APP_STORE_CONNECT_TEAM_ID": "TEAM123456"
  }
}
```

## ä¿å­˜ Android å‡­è¯

<Aside type="note">
**è¿˜æ²¡æœ‰å¯†é’¥åº“?** è¯·å‚é˜… [Android æ„å»ºæŒ‡å—](/docs/cli/cloud-build/android/#creating-a-keystore) äº†è§£å¦‚ä½•åˆ›å»ºå¯†é’¥åº“å’Œè®¾ç½® Play å•†åº—å‡­è¯çš„è¯´æ˜ã€‚
</Aside>

### å®Œæ•´ç¤ºä¾‹

```bash
npx @capgo/cli build credentials save \
  --platform android \
  --keystore ./release.keystore \
  --keystore-alias "my-key-alias" \
  --keystore-key-password "KeyPassword123" \
  --keystore-store-password "StorePassword123" \
  --play-config ./play-store-service-account.json
```

### Android é€‰é¡¹

| é€‰é¡¹ | æè¿° | å¿…éœ€ |
|--------|-------------|----------|
| `--keystore <path>` | .keystore æˆ– .jks æ–‡ä»¶çš„è·¯å¾„ | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--keystore-alias <alias>` | å¯†é’¥åº“ä¸­çš„å¯†é’¥åˆ«å | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--keystore-key-password <password>` | å¯†é’¥åˆ«åçš„å¯†ç  | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--keystore-store-password <password>` | å¯†é’¥åº“çš„å¯†ç  | æ˜¯(å‘å¸ƒç‰ˆæœ¬) |
| `--play-config <path>` | Play å•†åº—æœåŠ¡è´¦æˆ· JSON çš„è·¯å¾„ | æ˜¯(æäº¤) |

### å­˜å‚¨çš„å†…å®¹

å½“æ‚¨ä¿å­˜ Android å‡­è¯æ—¶,CLI ä¼š:
1. è¯»å–å¯†é’¥åº“å’ŒæœåŠ¡è´¦æˆ· JSON æ–‡ä»¶
2. å°†å®ƒä»¬è½¬æ¢ä¸º base64 ç¼–ç 
3. å°†å‡­è¯ä¿å­˜åˆ° `.capgo-credentials` æ–‡ä»¶å¤¹
4. å°†å¯†ç å’Œåˆ«åå­˜å‚¨ä¸ºçº¯æ–‡æœ¬(ä»…é™æœ¬åœ°æ–‡ä»¶)

å­˜å‚¨çš„æ–‡ä»¶ç»“æ„:
```json
{
  "android": {
    "ANDROID_KEYSTORE_FILE": "...",
    "PLAY_CONFIG_JSON": "...",
    "KEYSTORE_KEY_ALIAS": "my-key-alias",
    "KEYSTORE_KEY_PASSWORD": "...",
    "KEYSTORE_STORE_PASSWORD": "..."
  }
}
```

## ä½¿ç”¨å·²ä¿å­˜çš„å‡­è¯

ä¿å­˜å‡­è¯å,åœ¨æ„å»ºæ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨:

```bash
# å‡­è¯è‡ªåŠ¨ä» .capgo-credentials æ–‡ä»¶å¤¹åŠ è½½
npx @capgo/cli build com.example.app --platform ios
```

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡è¦†ç›–å·²ä¿å­˜çš„å‡­è¯:

```bash
# ç¯å¢ƒå˜é‡ä¼˜å…ˆäºå·²ä¿å­˜çš„å‡­è¯
BUILD_CERTIFICATE_BASE64="..." \
P12_PASSWORD="different-password" \
npx @capgo/cli build com.example.app --platform ios
```

**ä¼˜å…ˆçº§é¡ºåº:**
1. ç¯å¢ƒå˜é‡(æœ€é«˜ä¼˜å…ˆçº§)
2. `.capgo-credentials` æ–‡ä»¶å¤¹ä¸­çš„å·²ä¿å­˜å‡­è¯
3. æ— å‡­è¯(æœ€ä½ä¼˜å…ˆçº§)

## æŸ¥çœ‹å·²ä¿å­˜çš„å‡­è¯

åˆ—å‡ºæ‚¨å·²ä¿å­˜çš„å‡­è¯:

```bash
npx @capgo/cli build credentials list
```

ç¤ºä¾‹è¾“å‡º:
```
ğŸ“‹ å·²ä¿å­˜çš„æ„å»ºå‡­è¯:

iOS å‡­è¯:
  âœ“ è¯ä¹¦ (base64)
  âœ“ é…ç½®æ–‡ä»¶ (base64)
  âœ“ Apple å¯†é’¥å†…å®¹ (base64)
  âœ“ P12 å¯†ç : ********
  âœ“ Apple å¯†é’¥ ID: ABC1234567
  âœ“ Apple å‘è¡Œè€… ID: 00000000-0000-0000-0000-000000000000
  âœ“ å›¢é˜Ÿ ID: TEAM123456

Android å‡­è¯:
  âœ“ å¯†é’¥åº“ (base64)
  âœ“ Play å•†åº—é…ç½® (base64)
  âœ“ å¯†é’¥åº“åˆ«å: my-key-alias
  âœ“ å¯†é’¥å¯†ç : ********
  âœ“ å­˜å‚¨å¯†ç : ********

ä½ç½®: .capgo-credentials/

ğŸ”’ è¿™äº›å‡­è¯ä»…å­˜å‚¨åœ¨æ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šã€‚
   æ„å»ºæ—¶,å®ƒä»¬ä¼šå‘é€åˆ° Capgo ä½†æ°¸è¿œä¸ä¼šå­˜å‚¨åœ¨é‚£é‡Œã€‚
   æ„å»ºå®Œæˆåè‡ªåŠ¨åˆ é™¤(æœ€å¤š 24 å°æ—¶)ã€‚
```

## å®‰å…¨æœ€ä½³å®è·µ

### æœ¬åœ°å­˜å‚¨å®‰å…¨

1. **æ–‡ä»¶æƒé™**
   ```bash
   # ç¡®ä¿å‡­è¯æ–‡ä»¶å¤¹ä¸è¢«å…¶ä»–äººè¯»å–
   chmod 700 .capgo-credentials
   chmod 600 .capgo-credentials/*
   ```

2. **åˆ‡å‹¿æäº¤å‡­è¯**
   ```bash
   # æ·»åŠ åˆ° .gitignore
   echo ".capgo-credentials/" >> .gitignore
   ```

3. **åˆ†ç¦»å‡­è¯**
   - æœ¬åœ°å¼€å‘å’Œ CI/CD ä½¿ç”¨ä¸åŒçš„å‡­è¯
   - å®šæœŸè½®æ¢å‡­è¯
   - ä¸è¦åœ¨å›¢é˜Ÿæˆå‘˜ä¹‹é—´å…±äº«å‡­è¯

### CI/CD ä½¿ç”¨

å¯¹äº CI/CD ç¯å¢ƒ,**ä¼˜å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡**è€Œä¸æ˜¯å·²ä¿å­˜çš„å‡­è¯:

```yaml
# GitHub Actions
env:
  BUILD_CERTIFICATE_BASE64: ${{ secrets.IOS_CERTIFICATE }}
  P12_PASSWORD: ${{ secrets.P12_PASSWORD }}
  # ... å…¶ä»–å¯†é’¥
```

è¿™æ›´å®‰å…¨,å› ä¸º:
- å¯†é’¥ç”± CI/CD å¹³å°ç®¡ç†
- è¿è¡Œå™¨ä¸Šæ²¡æœ‰å‡­è¯æ–‡ä»¶
- æ˜“äºè½®æ¢å’Œè®¿é—®æ§åˆ¶
- å¯†é’¥ä½¿ç”¨çš„å®¡è®¡è·Ÿè¸ª

### å‡­è¯è½®æ¢

å®šæœŸè½®æ¢æ‚¨çš„å‡­è¯:

1. **iOS**: æ¯å¹´ç”Ÿæˆæ–°è¯ä¹¦å’Œ API å¯†é’¥
2. **Android**: æ¯å¹´æ›´æ”¹å¯†é’¥åº“å¯†ç 
3. **å›¢é˜Ÿå˜æ›´å**: å›¢é˜Ÿæˆå‘˜ç¦»å¼€æ—¶è½®æ¢

æ›´æ–°å·²ä¿å­˜çš„å‡­è¯:
```bash
# ä½¿ç”¨æ–°å‡­è¯é‡æ–°è¿è¡Œä¿å­˜å‘½ä»¤
npx @capgo/cli build credentials save --platform ios --certificate ./new-cert.p12 ...
```

## æ•…éšœæ’é™¤

### "æ‰¾ä¸åˆ°å‡­è¯"

å¦‚æœæ„å»ºè¯´æ‰¾ä¸åˆ°å‡­è¯:

1. **æ£€æŸ¥æ˜¯å¦ä¿å­˜äº†å‡­è¯**:
   ```bash
   npx @capgo/cli build credentials list
   ```

2. **å¦‚æœç¼ºå°‘å‡­è¯åˆ™ä¿å­˜**:
   ```bash
   npx @capgo/cli build credentials save --platform ios ...
   ```

3. **éªŒè¯å‡­è¯æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨**:
   ```bash
   ls -la .capgo-credentials/
   ```

### è¯»å–å‡­è¯æ—¶"æƒé™è¢«æ‹’ç»"

ä¿®å¤æ–‡ä»¶æƒé™:

```bash
chmod 700 .capgo-credentials
chmod 600 .capgo-credentials/*
```

### å‡­è¯æœªè¢«ä½¿ç”¨

æ£€æŸ¥æ˜¯å¦æŒ‡å®šäº†æ­£ç¡®çš„å¹³å°:

```bash
# ç¡®ä¿ --platform ä¸å·²ä¿å­˜çš„å‡­è¯åŒ¹é…
npx @capgo/cli build com.example.app --platform ios  # ä½¿ç”¨ ios å‡­è¯
npx @capgo/cli build com.example.app --platform android  # ä½¿ç”¨ android å‡­è¯
```

### æ¸…é™¤å¹¶é‡æ–°ä¿å­˜å‡­è¯

å¦‚æœå‡­è¯ä¼¼ä¹å·²æŸå:

```bash
# æ¸…é™¤æ‰€æœ‰å‡­è¯
npx @capgo/cli build credentials clear

# é‡æ–°ä¿å­˜
npx @capgo/cli build credentials save --platform ios ...
```

## ä»ç¯å¢ƒå˜é‡è¿ç§»

å¦‚æœæ‚¨å½“å‰ä½¿ç”¨ç¯å¢ƒå˜é‡,å¯ä»¥è¿ç§»åˆ°å·²ä¿å­˜çš„å‡­è¯:

<Steps>

1. **æå–å½“å‰ç¯å¢ƒå˜é‡**
   ```bash
   echo $BUILD_CERTIFICATE_BASE64  # éªŒè¯å®ƒä»¬å­˜åœ¨
   ```

2. **å°† base64 æ–‡ä»¶è§£ç å›åŸå§‹æ–‡ä»¶**(å¦‚æœéœ€è¦)
   ```bash
   echo "$BUILD_CERTIFICATE_BASE64" | base64 -d > cert.p12
   echo "$BUILD_PROVISION_PROFILE_BASE64" | base64 -d > profile.mobileprovision
   ```

3. **ä½¿ç”¨ CLI ä¿å­˜**
   ```bash
   npx @capgo/cli build credentials save \
     --platform ios \
     --certificate ./cert.p12 \
     --provisioning-profile ./profile.mobileprovision \
     --p12-password "$P12_PASSWORD" \
     --apple-key-id "$APPLE_KEY_ID" \
     --apple-issuer-id "$APPLE_ISSUER_ID" \
     --apple-team-id "$APP_STORE_CONNECT_TEAM_ID"
   ```

4. **æµ‹è¯•æ„å»º**
   ```bash
   npx @capgo/cli build com.example.app --platform ios
   ```

5. **åˆ é™¤ç¯å¢ƒå˜é‡**(å¯é€‰)
   ```bash
   unset BUILD_CERTIFICATE_BASE64 BUILD_PROVISION_PROFILE_BASE64
   ```

</Steps>

## æ–‡ä»¶ä½ç½®

å‡­è¯å­˜å‚¨åœ¨ `.capgo-credentials` æ–‡ä»¶å¤¹ä¸­:
- **macOS/Linux**: `.capgo-credentials/`(åœ¨æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•æˆ–ä¸»ç›®å½•)
- **Windows**: `.capgo-credentials\`(åœ¨æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•æˆ–ä¸»ç›®å½•)

é¦–æ¬¡ä¿å­˜å‡­è¯æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥æ–‡ä»¶å¤¹ã€‚

## ä¸‹ä¸€æ­¥

- [å…¥é—¨](/docs/cli/cloud-build/getting-started/) - åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæ„å»º
- [iOS æ„å»º](/docs/cli/cloud-build/ios/) - iOS ç‰¹å®šçš„æ„å»ºé…ç½®
- [Android æ„å»º](/docs/cli/cloud-build/android/) - Android ç‰¹å®šçš„æ„å»ºé…ç½®
- [æ•…éšœæ’é™¤](/docs/cli/cloud-build/troubleshooting/) - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

## éœ€è¦å¸®åŠ©?

- ğŸ“š [æ•…éšœæ’é™¤æŒ‡å—](/docs/cli/cloud-build/troubleshooting/)
- ğŸ’¬ [Discord ç¤¾åŒº](https://discord.com/invite/VnYRvBfgA6)
- ğŸ“§ ç”µå­é‚®ä»¶: support@capgo.app
