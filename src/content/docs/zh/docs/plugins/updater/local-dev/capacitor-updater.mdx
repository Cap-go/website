---
title: "在自托管 capgo 中使用 capacitor updater"
locale: zh
description: "如何在自托管 Capgo 中使用 capacitor updater，完全自主地使用您自己的 Capgo 实例"
sidebar:
    order: 4
---

## 本教程将涵盖什么？

本教程将展示如何在自托管 capgo 的开发环境中使用 capacitor updater

## 要求

 1. [已克隆 capgo](https://github.com/Cap-go/capgo)

## 入门指南

要在自托管 capgo 中使用 capacitor updater，请编辑应用目录中的 `capacitor.config.ts` 并将其设置为：

```ts
const config: CapacitorConfig = {
  appId: 'com.demo.app',
  appName: 'demoApp',
  webDir: 'dist',
  bundledWebRuntime: false,
  plugins: {
    CapacitorUpdater : {
      statsUrl: "https://localhost:54321/functions/v1/stats",
      channelUrl: "https://localhost:54321/functions/v1/channel_self",
      updateUrl: "https://localhost:54321/functions/v1/updates"
    },
  },
};
```

这将使您能够在开发中使用本地 capgo。但是，默认情况下，这还不够。

> 默认情况下，iOS 和 Android 都要求您使用 HTTPS，您需要使用 Ngrock 或 localcan 等工具在 https 中代理您的 API。

Android 中有一种启用[明文通信](https://developer.android.com/topic/security/risks/cleartext)的方法。
这可以通过修改 [AndroidManifest.xml](https://github.com/Cap-go/capacitor-updater/blob/main/android/src/main/AndroidManifest.xml) 并在 `application` 标签中添加 `android:usesCleartextTraffic="true"` 来实现
可以在[这里](https://gist.github.com/WcaleNieWolny/061a015acdebe35eaf3afd7030797701)看到此更改的完整示例

还可能存在阻止 Android 应用连接的问题。如果您没有看到任何请求发送到边缘函数，请运行
```bash
adb reverse tcp:54321 tcp:54321
```
