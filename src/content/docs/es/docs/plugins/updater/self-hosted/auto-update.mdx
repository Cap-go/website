---
title: "Actualización Automática"
locale: es
description: "Cómo usar el endpoint de actualización de Capgo con el Plugin de actualización automática en modo auto-hospedado, para qué se utilizan y qué esperar"
sidebar:
  order: 4
---

Importar { LinkCard, CardGrid } De '@astrojs/starlight/components';

Esta documentación explicará cómo ejecutar tu servidor de actualización automática.

## Servir tu Paquete
Asegúrate de que tu Paquete se sirva a través de HTTPS, y que el servidor tenga los encabezados CORS correctos para permitir que la aplicación descargue la actualización.
por ejemplo, ```https://myserver.com/app/updates/updates.json```


Si no estás familiarizado con servir un Paquete, te recomendamos que pruebes Capgo Cloud o veas un ejemplo aquí:
<LinkCard
	title="Servir un Paquete"
	href="/docs/self-hosted/auto-Actualizar/Actualizar-endpoint"
/>

## Configuración
Agrega un ``updateUrl`` a tu ``capacitor.config.json``.

__CODEBLOCK_1__
:::caution
Cuando estés enviando una actualización auto-hospedada, ten en cuenta que no puedes usar un endpoint "HTTP" ya que va en contra de las políticas de seguridad de las aplicaciones Android, para propósitos de prueba puedes [permitirlo](https://stackoverflow.com/questions/45940861/android-8-cleartext-http-traffic-not-permitted).
:::

## API de Actualización

El plugin hará una llamada POST a tu API cada vez que la aplicación se abra, con este body:

__CODEBLOCK_2__

La API del servidor debe responder, en JSON, al plugin capacitor-updater. Con estos datos si es necesaria una actualización:

__CODEBLOCK_3__

En modo de actualización automática, el servidor debe comparar las versiones y devolver la correcta, si la clave URL está presente, el plugin inicia el proceso de descarga.

Si agregas las claves "message" y "error", la versión no se establecerá, y el mensaje se mostrará en los logs en su lugar.

La clave `version` debe estar en formato [`semver`](https://semver.org/).

El zip debe tener `index.html` como archivo en la raíz, o solo una carpeta en la raíz con `index.html` dentro.


Puedes usar el comando del CLI para comprimir tu bundle:

__CODEBLOCK_4__

## Generación del Checksum del Bundle

**Importante:** Debes usar el CLI de Capgo para crear tu archivo zip del bundle. El plugin de Capgo requiere un formato y estructura de zip específicos que solo están garantizados cuando se usa la herramienta CLI oficial. Las utilidades zip estándar pueden crear archivos incompatibles.

Para generar el checksum de tu bundle, usa el comando zip del CLI de Capgo con la bandera `--json`:

__CODEBLOCK_5__

Este comando:
- Creará un archivo zip correctamente formateado compatible con el plugin de Capgo
- Generará el checksum SHA256 para verificación de integridad
- Mostrará la información del bundle en formato JSON

Ejemplo de salida:
__CODEBLOCK_6__

Usa el valor `checksum` de esta salida en la respuesta de tu API para asegurar que el Plugin pueda verificar la integridad del Paquete antes de la instalación.
