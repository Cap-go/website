---
title: Login Google con Firebase su iOS
locale: it
description: Scopri come configurare l'accesso con Google utilizzando Firebase Authentication su iOS con il plugin Capacitor Social Login.
sidebar:
    order: 3
---
import { Steps } from '@astrojs/starlight/components';

## Introduzione

Questa guida ti aiuterà a integrare l'accesso con Google utilizzando Firebase Authentication su iOS. Suppongo che tu abbia già completato la [configurazione generale di Firebase Google](./general/).

:::note
Suppongo che tu non abbia ancora creato la tua app iOS nella Console Firebase. Se l'hai già fatto, i passaggi saranno leggermente diversi.
:::

## Passaggi di configurazione

<Steps>
1. Vai alla panoramica del progetto su [console.cloud.google.com](https://console.cloud.google.com/)
    <img src="/social-login-assets/firebase_project_overview.webp" alt="Firebase Project Overview" />

2. Fai clic sul pulsante `Add app`
    <img src="/social-login-assets/firebase_project_add_app.webp" alt="Firebase Add App Button" />

    :::note
    È possibile che tu debba cercare questo pulsante qui. Questo si applica solo se hai già creato un'app diversa nella Console Firebase.
    :::

    <img src="/social-login-assets/firebase_project_add_app_2.webp" alt="Firebase Add App Button" />
3. Seleziona `iOS`
    <img src="/social-login-assets/firebase_project_add_app_ios.webp" alt="Firebase Add App iOS Button" />

4. Compila la prima parte del modulo
   1. Compila il campo `Apple bundle ID`
      1. Apri Xcode nella tua app utilizzando `npx cap open ios`
      2. Fai doppio clic su `App`
         <img src="/social-login-assets/xcode_app_click.png" alt="App target in Xcode project navigator" />
      3. Assicurati di essere su `Targets -> App`
         <img src="/social-login-assets/xcode_targets_app.png" alt="Targets section in Xcode with App selected" />
      4. Trova il tuo `Bundle Identifier`
          <img src="/social-login-assets/xcode_bundle_id.png" alt="Bundle Identifier field in Xcode project settings" />
          :::note
          L'ID mostrato qui differirà da quello che userò per il resto della guida. Userò `app.capgo.plugin.SocialLogin` per il resto della guida.
          :::
      5. Copia il `Bundle Identifier` e incollalo nella console Firebase
         <img src="/social-login-assets/firebase_project_add_app_ios_bundle_id.webp" alt="Firebase Add App iOS Bundle ID Field" />
   2. Fai clic sul pulsante `Register app`
         <img src="/social-login-assets/firebase_project_add_app_ios_register.webp" alt="Firebase Add App iOS Register Button" />
5. Salta il passaggio `Download config file`
    <img src="/social-login-assets/firebase_project_add_app_ios_skip_download.webp" alt="Firebase Add App iOS Skip Download Button" />
6. Salta il passaggio `Add firebase SDK`
    <img src="/social-login-assets/firebase_project_add_app_ios_skip_download_firebase_sdk_2.webp" alt="Firebase Add App iOS Skip Download Firebase SDK Button" />
7. Salta il passaggio `Add initialization code`
    <img src="/social-login-assets/firebase_project_add_app_ios_skip_download_firebase_sdk.webp" alt="Firebase Add App iOS Skip Add Initialization Code Button" />
8. Fai clic sul pulsante `Continue to console`
    <img src="/social-login-assets/firebase_project_add_app_ios_continue_to_console.webp" alt="Firebase Add App iOS Continue to Console Button" />
9. Ottieni il tuo iOS client ID e il tuo `YOUR_DOT_REVERSED_IOS_CLIENT_ID`
   1. Vai alla Google Cloud Console su [console.cloud.google.com](https://console.cloud.google.com/)
   2. Trova il tuo progetto
      1. Fai clic sul selettore del progetto
         <img src="/social-login-assets/firebase_double_check_gc_project_select.webp" alt="Google Cloud Console Project Selector" />
      2. Cerca il tuo progetto con il nome esatto del tuo progetto Firebase e fai clic su di esso. Nel mio caso, è `sociallogin-tutorial-app`.
         <img src="/social-login-assets/firebase_gc_project_select_project.webp" alt="Firebase Project Selector Project" />
   3. Apri la barra di ricerca e cerca `credentials`
      1. Apri la barra di ricerca
         <img src="/social-login-assets/firebase_double_check_gc_search_bar.webp" alt="Google Cloud Console Search Bar" />
      2. Cerca `credentials` e fai clic su quello di `APIs and Services` (numero 2 nello screenshot)
         <img src="/social-login-assets/firebase_gc_credentials_search.webp" alt="Google Cloud Console Credentials Search" />
   4. Fai clic su `iOS client for [YOUR_APP_ID] (auto created by Google Service)`. Nel mio caso, è `sociallogin-tutorial-app`.
      <img src="/social-login-assets/firebase_gc_credentials_ios_client_id.webp" alt="Google Cloud Console Credentials iOS Client ID" />
   5. Copia il `Client ID` e l'`iOS URL scheme`. Questi saranno rispettivamente il tuo `iOSClientId` e `YOUR_DOT_REVERSED_IOS_CLIENT_ID`.

      :::note
      Passerai l'`iOSClientId` nel metodo `initialize` del plugin, mentre userai il `YOUR_DOT_REVERSED_IOS_CLIENT_ID` nel file `Info.plist` della tua app, come spiegato nella prossima parte di questa guida.
      :::

      <img src="/social-login-assets/firebase_gc_credentials_ios_client_id_copy.webp" alt="Google Cloud Console Credentials iOS Client ID Copy" />
10. Ottieni il tuo web client ID
    1. Torna alla console Firebase e vai su `Build` -> `Authentication`
        <img src="/social-login-assets/firebase_select_authentication.webp" alt="Firebase Authentication Menu" />
    2. Fai clic sul pulsante `Sign-in method`
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method.webp" alt="Firebase Authentication Sign-in Method Button" />
    3. Fai clic sul provider `Google`
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method_google.webp" alt="Firebase Authentication Sign-in Method Google Provider" />
    4. Fai clic sul pulsante `Web SDK configuration`
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method_web_sdk_configuration.webp" alt="Firebase Authentication Sign-in Method Web SDK Configuration Button" />
    5. Copia il `Web client ID`. Questo sarà il tuo `webClientId` nel metodo `initialize` del plugin.
        <img src="/social-login-assets/firebase_select_authentication_sign_in_method_web_sdk_configuration_web_client_id.webp" alt="Firebase Authentication Sign-in Method Web SDK Configuration Web Client ID" />
11. Modifica il file Info.plist della tua app
    1. Apri Xcode e trova il file `Info.plist`
        <img src="/social-login-assets/xcode_info_file.png" alt="Info.plist file in Xcode project navigator" />
    2. Fai clic destro su questo file e aprilo come codice sorgente
        <img src="/social-login-assets/xcode_open_as_src_code.png" alt="Right-click menu showing Open As Source Code option" />
    3. In fondo al tuo file `Plist`, vedrai un tag `</dict>`
        <img src="/social-login-assets/xcode_dict_tag.png" alt="Closing dict tag in Info.plist file" />
    4. Inserisci il seguente frammento appena prima del tag di chiusura `</dict>`
        <img src="/social-login-assets/xcode_plist_inserted.png" alt="Info.plist with URL schemes code inserted before closing dict tag" />

        ```xml
        <key>CFBundleURLTypes</key>
        <array>
        <dict>
          <key>CFBundleURLSchemes</key>
          <array>
            <string>YOUR_DOT_REVERSED_IOS_CLIENT_ID</string>
          </array>
        </dict>
        </array>
        <key>GIDClientID</key>
        <string>YOUR_IOS_CLIENT_ID.apps.googleusercontent.com</string>
        ```

    5. Cambia `YOUR_DOT_REVERSED_IOS_CLIENT_ID` con il valore copiato nel passaggio 9 (l'iOS URL scheme)
        <img src="/social-login-assets/xcode_plist_final.png" alt="Info.plist with actual reversed client ID inserted in URL schemes" />

        :::caution
        Assicurati che questo valore **INIZI** con `com.googleusercontent.apps`
        :::

   6. Cambia `YOUR_IOS_CLIENT_ID` con l'iOS Client ID che hai copiato nel passaggio 9

   7. Salva il file con `Command + S`

12. Modifica l'`AppDelegate.swift`
    1. Apri l'AppDelegate
        <img src="/social-login-assets/xcode_app_deleg.png" alt="AppDelegate.swift file in Xcode project navigator" />
    2. Inserisci `import GoogleSignIn` all'inizio del file
        <img src="/social-login-assets/xcode_app_deleg_google_sign_in.png" alt="AppDelegate.swift with GoogleSignIn import added" />
    3. Trova la funzione `func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:])`
        <img src="/social-login-assets/xcode_app_deleg_app_fn.png" alt="Original application openURL function in AppDelegate" />
    4. Modifica la funzione in questo modo

        ```swift
        func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey: Any] = [:]) -> Bool {
            // Called when the app was launched with a url. Feel free to add additional processing here,
            // but if you want the App API to support tracking app url opens, make sure to keep this call

            var handled: Bool

            handled = GIDSignIn.sharedInstance.handle(url)
            if handled {
              return true
            }

            return ApplicationDelegateProxy.shared.application(app, open: url, options: options)
        }
        ```

        <img src="/social-login-assets/xcode_app_deleg_app_fn_mod.png" alt="Modified application openURL function with GoogleSignIn handling" />

    5. Salva il file con `Command + S`

15. Utilizzo del login Google nella tua app

    A questo punto, sei pronto per utilizzare il login Google nella tua app.
    Utilizza il file [authUtils.ts](https://github.com/Cap-go/capacitor-social-login/blob/main/example-app/src/authUtils.ts) dell'app di esempio per autenticarti con Google.
</Steps>

 L'utente verrà creato automaticamente in Firebase Auth al primo accesso

## Risoluzione dei problemi

Se l'autenticazione si blocca o fallisce:

- Verifica che l'audience dell'`idToken` corrisponda al tuo Firebase web client ID
- Controlla che l'accesso con Google sia abilitato nella Console Firebase
- Assicurati che Info.plist abbia gli URL schemes corretti e GIDClientID
- Verifica che `iOSServerClientId` corrisponda al tuo web client ID
- Rivedi il [codice dell'app di esempio](https://github.com/Cap-go/capacitor-social-login/tree/main/example-app/src/authUtils.ts) come riferimento


