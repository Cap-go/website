---
title: Einf√ºhrung - Automatische Aktualisierung
description: Wie man das Auto-Update-Plugin im selbst-gehosteten Modus verwendet
sidebar:
  order: 1
locale: de
---

import { LinkCard, CardGrid } from '@astrojs/starlight/components';

Diese Dokumentation erkl√§rt, wie Sie Ihren Auto-Update-Server ausf√ºhren k√∂nnen

## Vor dem Start

Wenn Sie an dieser Arbeit selbstst√§ndig arbeiten, kann ich nicht mehr empfehlen, meine Arbeit √ºber [dies](https://githubcom/sponsors/riderx/) zu unterst√ºtzen

Ich habe eine gro√üe Wette darauf abgeschlossen, allen wertvollen Code, den ich hier erstellt habe, als Open Source bereitzustellen

Ich h√§tte es f√ºr mich behalten und einen hohen Ticketpreis verlangen k√∂nnen

Dar√ºber hinaus m√∂chte ich mich auf Capgo-Tools konzentrieren und es zu einem offenen und transparenten Gesch√§ft machen

Ebenso denke ich, dass es unsere Welt zu einem besseren Ort machen w√ºrde, indem wir √∂ffnen, anstatt zu k√§mpfen und uns zu verstecken

Aber um das m√∂glich zu machen, m√ºssen wir alle unseren Teil dazu beitragen, einschlie√ülich Ihnen ü•π

Wenn die Angebote von Capgo Ihnen nicht zusagen, dann nennen Sie Ihren Preis und unterst√ºtzen Sie einen bootstrap-finanzierten Maker [HIER](https://githubcom/sponsors/riderx/) zu Ihren Bedingungen

## Schnelle Installationen

```
npm install @capgo/capacitor-updater
npx cap sync
```

### Konfiguration

Sie m√ºssen das Plugin so konfigurieren, dass es Ihre URL verwendet:

```json
{
	"plugins": {
		"CapacitorUpdater": {
			"updateUrl": "https://YOURURL",
		}
	}
}
```

> üöß Bei Android ist es nicht erlaubt, HTTP-Anfragen zu stellen. Zu Testzwecken [erlauben Sie es](https://stackoverflowcom/questions/45940861/android-8-cleartext-http-traffic-not-permitted/)

### Update-API

Das Plugin wird bei jedem √ñffnen der App einen POST-Call an Ihre API durchf√ºhren, mit diesem Body:

```typescript
interface AppInfos {
    "platform": "ios" | "android",
    "device_id": "UUID_of_device_unique_by_install",
    "app_id": "APPID_FROM_CAPACITOR_CONFIG",
    "custom_id": "your_custom_id_set_on_runtime",
    "plugin_version": "PLUGIN_VERSION",
    "version_build": "VERSION_NUMBER_FROM_NATIVE_CODE",
    "version_code": "VERSION_CODE_FROM_NATIVE_CODE",
    "version_name": "LAST_DOWNLOADER_VERSION" | "builtin",
    "version_os": "VERSION_OF_SYSYEM_OS",
    "is_emulator": boolean,
    "is_prod": boolean,
}
```

Die Server-API sollte mit diesen Daten in JSON auf das capacitor-updater-Plugin antworten, wenn ein Update erforderlich ist:

```json
{
"version": "123",
"url": "https://path_to_the_zip_file_of_the_codecom"
}
```

Bei der automatischen Aktualisierung sollte der Server die Arbeit des Vergleichens der Version √ºbernehmen und die richtige zur√ºckgeben. Wenn der URL-Schl√ºssel vorhanden ist, beginnt das Plugin mit dem Downloadprozess.

Wenn Sie die Schl√ºssel "message" und "error" hinzuf√ºgen, wird die Version nicht gesetzt und die Nachricht wird anstelle dessen in den Protokollen angezeigt.

Der `version`-Schl√ºssel sollte im [`semver`](https://semverorg/) Format sein.

Die Zip-Datei sollte `indexhtml` als Datei im Stammordner oder nur einen Ordner im Stammordner mit `indexhtml` darin haben.

Sie k√∂nnen den Befehl der CLI verwenden, um Ihr Bundle zu zippen:

```bash
npx @capgo/cli bundle zip --path [/path/to/my/bundle]
```

<LinkCard
	title="Update-Endpunkt"
	href="/docs/self-hosted/auto-update/update-endpoint"
/>

#### End-to-End-Verschl√ºsselung

Ab Version 4150 erm√∂glicht das Plugin, verschl√ºsselte Updates zu senden.

Sie k√∂nnen diese Funktion nutzen, indem Sie einen privaten Schl√ºssel erstellen ``npx @capgo/cli key create``.

Dann verschl√ºsseln Sie Ihre Zip-Datei mit ``npx @capgo/cli encrypt [path/to/zip]``.

Der Befehl gibt Ihnen einen `ivSessionKey` aus, der zusammen mit Ihrem Update-Payload im Schl√ºssel `session_key` gesendet werden muss. Dann kann Ihre App den privaten Schl√ºssel verwenden, um den `session_key` zu entschl√ºsseln und den entschl√ºsselten `session_key` zum Entschl√ºsseln des Updates zu verwenden.

Erfahren Sie hier mehr:

<LinkCard
	title="Selbstgehostete Live-Updates"
	href="https://capgoapp/blog/self-hosted-live-updates/"
/>

### Statistik-API

Ab Version 130 sendet das Updatesystem Statistiken!

Standardm√§√üig werden alle Statistiken an unseren Server gesendet, um die Nutzung zu verstehen.

> üí° Es werden keine privaten Daten f√ºr Statistiken gesendet, nur zuf√§llige UUID, Versionsaktualisierung, Version der nativen App, Plattform, Aktion und App-ID.

Wenn Sie stattdessen Daten an Ihren Server senden m√∂chten, √§ndern Sie die Konfiguration unten:

```tsx
// capacitorconfigjson
{
	"appId": "*******",
	"appName": "Name",
	"plugins": {
		"CapacitorUpdater": {
			"statsUrl": "YOUR_URL"
		}
	}
}
```

Was Ihr Server erhalten wird, ist:

```tsx
interface AppInfosStats {
	"action": "set", // kann festgelegt, gel√∂scht, set_fail, zur√ºckgesetzt, zur√ºckgekehrt werden
	// Dann sind es die gleichen Informationen wie bei der Aktualisierung
	"app_id": "*******", // App-Identifikator im Store
	"device_id": "*******", // eindeutige ID pro App-Installation
	"platform": "ios", // oder Android
	"custom_id": "user_1", // repr√§sentiert Ihren Benutzer
	"version_name": "123", // Version des Web-Builds
	"version_build": "120", // Version des nativen Builds
	"version_code": "120", // Build-Nummer des nativen Builds
	"version_os": "16", // OS-Version des Ger√§ts
	"plugin_version": "400", // damit Ihre API sich unterschiedlich mit verschiedenen Plugins verh√§lt
	"is_emulator": false,
	"is_prod": false,
}
```

Sie k√∂nnen es auch vollst√§ndig deaktivieren, indem Sie einen leeren String verwenden. Beachten Sie, dass Statistiken benutzerfreundlich gemacht werden und mir helfen, zu verstehen, wie Menschen das Plugin nutzen, Probleme zu beheben und es zu verbessern.

<LinkCard
	title="Stats-Endpunkt"
	href="/docs/self-hosted/auto-update/stats-endpoint"
/>

### Kanal-API

Zu dokumentieren.