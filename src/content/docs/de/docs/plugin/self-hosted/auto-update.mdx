---
title: Automatische Aktualisierung
description: Wie man das Auto-Update-Plugin im selbstgehosteten Modus verwendet
sidebar:
  order: 3
locale: de
---

import { LinkCard, CardGrid } from '@astrojs/starlight/components';

Diese Dokumentation erklärt, wie Sie Ihren Auto-Update-Server ausführen

## Bereitstellung Ihres Bundles
Stellen Sie sicher, dass Ihr Bundle über HTTPS bereitgestellt wird und der Server die richtigen CORS-Header hat, um der App das Herunterladen des Updates zu ermöglichen.
z.B. ```https://myservercom/app/updates/updatesjson```

Wenn Sie mit der Bereitstellung eines Bundles nicht vertraut sind, empfehlen wir, Capgo Cloud auszuprobieren oder ein Beispiel hier zu sehen:
<LinkCard
	title="Bereitstellung eines Bundles"
	href="/docs/self-hosted/auto-update/update-endpoint"
/>

## Konfiguration
Fügen Sie eine ``updateUrl`` zu Ihrer ``capacitorconfigjson`` hinzu

```json
{
	"plugins": {
		"CapacitorUpdater": {
			"updateUrl": "https://myservercom/app/updates/updatesjson",
		}
	}
}
```
:::caution
Wenn Sie ein selbst gehostetes Update pushen, beachten Sie, dass Sie keinen "HTTP"-Endpunkt verwenden können, da dies gegen die Sicherheitsrichtlinien von Android-Apps verstößt. Zu Testzwecken können Sie [es erlauben](https://stackoverflowcom/questions/45940861/android-8-cleartext-http-traffic-not-permitted)
:::

## Update API

Das Plugin führt bei jedem Öffnen der App einen POST-Aufruf an Ihre API durch, mit diesem Body:

```typescript
interface AppInfos {
    "platform": "ios" | "android",
    "device_id": "UUID_of_device_unique_by_install",
    "app_id": "APPID_FROM_CAPACITOR_CONFIG",
    "custom_id": "your_custom_id_set_on_runtime",
    "plugin_version": "PLUGIN_VERSION",
    "version_build": "VERSION_NUMBER_FROM_NATIVE_CODE",
    "version_code": "VERSION_CODE_FROM_NATIVE_CODE",
    "version_name": "LAST_DOWNLOADER_VERSION" | "builtin",
    "version_os": "VERSION_OF_SYSYEM_OS",
    "is_emulator": boolean,
    "is_prod": boolean,
}
```

Die Server-API sollte in JSON an das capacitor-updater-Plugin mit diesen Daten antworten, wenn ein Update erforderlich ist:

```json
{
"version": "123",
"url": "https://myservercom/app/updates/my-new-app-200zip"
}
```

Im Auto-Update-Modus sollte der Server die Versionen vergleichen und die richtige zurückgeben. Wenn der URL-Schlüssel vorhanden ist, startet das Plugin den Download-Prozess.

Wenn Sie den Schlüssel "message" und "error" hinzufügen, wird die Version nicht gesetzt, und die Nachricht wird stattdessen in den Protokollen angezeigt.

Der Schlüssel `version` sollte im [`semver`](https://semverorg/) Format vorliegen.

Die Zip-Datei sollte `indexhtml` als Datei im Root-Verzeichnis haben, oder nur einen Ordner im Root-Verzeichnis mit `indexhtml` darin.

Sie können den Befehl der CLI verwenden, um Ihr Bundle zu zippen:

```bash title="Erstellen Sie ein Bundle mit Ihren Dateien, um von Ihrem Server bereitgestellt zu werden"
npx @capgo/cli bundle zip --path [/path/to/my/bundle]
```