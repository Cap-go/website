---
import * as m from '@/paraglide/messages'

// Helper to get dynamic message keys
type MessageFn = (args: Record<string, never>, options: { locale: string }) => string
const messages = m as unknown as Record<string, MessageFn>

const partnerLogos = [
  {
    name: 'Kick',
    logo: '/kick_logo.webp',
    alt: 'Kick',
    badgeKey: 'companies_logo_downloads_kick',
    floatDelay: null,
  },
  {
    name: 'Pizza Hut',
    logo: '/pizza_hut_logo.webp',
    alt: 'Pizza Hut',
    badgeKey: 'companies_logo_downloads_pizzahut',
    floatDelay: '0.5s',
  },
  {
    name: 'Remnote',
    logo: '/remnote_logo.svg',
    alt: 'Remnote',
    badgeKey: 'companies_logo_downloads_remnote',
    floatDelay: null,
  },
  {
    name: 'Hello Revel',
    logo: '/revel_logo.svg',
    alt: 'Hello Revel',
    badgeKey: 'companies_logo_downloads_revel',
    floatDelay: '1s',
  },
  {
    name: 'Nana',
    logo: '/nana-logo-transparent.webp',
    alt: 'Nana',
    badgeKey: 'companies_logo_downloads_nana',
    floatDelay: null,
  },
  {
    name: 'Suez',
    logo: '/suez_logo.webp',
    alt: 'Suez',
    badgeKey: 'companies_logo_downloads_suez',
    floatDelay: '1.5s',
  },
  {
    name: 'IREC',
    logo: '/irec_logo.webp',
    alt: 'IREC',
    badgeKey: 'companies_logo_downloads_irec',
    floatDelay: null,
  },
  {
    name: 'Vella',
    logo: '/vella_logo.svg',
    alt: 'Vella',
    badgeKey: 'companies_logo_downloads_vella',
    floatDelay: '2s',
  },
  {
    name: 'OurLiving',
    logo: '/ourliving_logo.webp',
    alt: 'OurLiving',
    badgeKey: 'companies_logo_downloads_ourliving',
    floatDelay: null,
  },
]
---

<section class="overflow-hidden relative py-24 bg-slate-50">
  <div class="container px-4 mx-auto">
    <!-- Background Elements -->
    <div class="absolute inset-0 rounded-3xl bg-white/60"></div>
    <div class="absolute top-0 right-0 w-72 h-72 rounded-full bg-blue-400/10 blur-3xl"></div>
    <div class="absolute bottom-0 left-0 w-72 h-72 rounded-full bg-indigo-400/10 blur-3xl"></div>

    <div class="relative mx-auto max-w-7xl">
      <div class="grid gap-16 items-center lg:grid-cols-2">
        <!-- Left Column - Content -->
        <div class="space-y-8">
          <!-- Badge -->
          <div class="inline-flex gap-2 items-center py-2 px-4 bg-blue-50 rounded-full border border-blue-200/50">
            <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
            <span class="text-sm font-medium text-blue-700">{m.trusted_by_developers_worldwide({}, { locale: Astro.locals.locale })}</span>
          </div>

          <div>
            <h2 class="mb-6 text-5xl font-bold leading-tight lg:text-6xl text-slate-900">
              {m.youre_in_good_company({}, { locale: Astro.locals.locale })}
            </h2>
            <p class="text-xl leading-relaxed text-slate-600">
              {m.capgo_enables_development_teams_at_some_of_the_most_innovative_companies({}, { locale: Astro.locals.locale })}
            </p>
          </div>

          <!-- Stats -->
          <div class="grid grid-cols-3 gap-8 pt-8">
            <div class="text-center">
              <div class="mb-2 text-3xl font-bold text-slate-900">{m.companies_logo_stat_companies_value({}, { locale: Astro.locals.locale })}</div>
              <div class="text-sm text-slate-600">{m.companies_logo_stat_companies_label({}, { locale: Astro.locals.locale })}</div>
            </div>
            <div class="text-center">
              <div class="mb-2 text-3xl font-bold text-slate-900">{m.companies_logo_stat_devices_value({}, { locale: Astro.locals.locale })}</div>
              <div class="text-sm text-slate-600">{m.companies_logo_stat_devices_label({}, { locale: Astro.locals.locale })}</div>
            </div>
            <div class="text-center">
              <div class="mb-2 text-3xl font-bold text-slate-900">
                <a href="https://status.capgo.app" target="_blank" rel="noopener noreferrer" class="transition-colors hover:text-blue-600 hover:underline">
                  {m.companies_logo_stat_uptime_value({}, { locale: Astro.locals.locale })}
                </a>
              </div>
              <div class="text-sm text-slate-600">{m.companies_logo_stat_uptime_label({}, { locale: Astro.locals.locale })}</div>
            </div>
          </div>
        </div>

        <!-- Right Column - Company Logos -->
        <div class="relative">
          <!-- Floating background elements -->
          <div class="absolute inset-0"></div>

          <div class="relative p-8 lg:p-12">
            <div class="grid grid-cols-3 gap-6">
              {
                partnerLogos.map((company) => (
                  <div
                    class={`company-logo rounded-2xl border border-slate-200/50 bg-white p-6 shadow-lg backdrop-blur-sm transition-all duration-300 hover:-translate-y-2 hover:shadow-xl ${company.floatDelay ? 'animate-float' : ''}`}
                    style={company.floatDelay ? `animation-delay: ${company.floatDelay};` : undefined}
                  >
                    <div class="flex relative justify-center items-center h-16">
                      <img loading="lazy" class="w-auto h-auto max-h-12 transition-transform hover:scale-105" src={company.logo} alt={company.alt} aria-label={company.name} />
                      <span class="absolute -top-3 -right-3 py-0.5 px-2.5 font-semibold text-white whitespace-nowrap rounded-full border shadow-md border-white/60 bg-slate-900 text-[10px]">
                        {messages[company.badgeKey]({}, { locale: Astro.locals.locale })}
                      </span>
                    </div>
                  </div>
                ))
              }
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom section with additional trust indicators -->
      <div class="mt-10">
        <div class="space-y-6 text-center">
          <p class="text-lg text-slate-600">
            {m.companies_logo_bottom_text({}, { locale: Astro.locals.locale })}
          </p>
          <div class="flex gap-8 justify-center items-center text-sm text-slate-500">
            <div class="flex flex-col gap-1 items-center">
              <img loading="lazy" src="/soc2.svg" alt={m.soc2_compliance_short({}, { locale: Astro.locals.locale })} class="w-auto h-20 transition-opacity hover:opacity-80" />
              <span class="text-xs font-semibold text-slate-500">{m.soc2_compliance_short({}, { locale: Astro.locals.locale })}</span>
            </div>
            <div class="flex flex-col gap-1 items-center">
              <img loading="lazy" src="/soc1.svg" alt={m.compliance_soc1({}, { locale: Astro.locals.locale })} class="w-auto h-20 transition-opacity hover:opacity-80" />
              <span class="text-xs font-semibold text-slate-500">{m.compliance_soc1({}, { locale: Astro.locals.locale })}</span>
            </div>
            <div class="flex flex-col gap-1 items-center">
              <img loading="lazy" src="/gdpr.svg" alt={m.compliance_gdpr({}, { locale: Astro.locals.locale })} class="w-auto h-20 transition-opacity hover:opacity-80" />
              <span class="text-xs font-semibold text-slate-500">{m.compliance_gdpr({}, { locale: Astro.locals.locale })}</span>
            </div>
          </div>
          <div class="mt-6">
            <a href="https://trust.capgo.app" class="inline-flex gap-2 items-center text-sm font-semibold text-blue-600 hover:text-blue-700">
              {m.trust_center({}, { locale: Astro.locals.locale })}
              <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 3h7m0 0v7m0-7L10 14"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10v11h11"></path>
              </svg>
            </a>
          </div>
          <p class="mx-auto mt-4 max-w-2xl text-xs text-center text-slate-500">
            {m.enterprise_security_audit_desc({}, { locale: Astro.locals.locale })}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Add intersection observer for fade-in animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px',
  }

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('animate-fade-in')
      }
    })
  }, observerOptions)

  // Observe all logo cards
  document.querySelectorAll('.company-logo').forEach((card) => {
    observer.observe(card)
  })

  // Add staggered animation delays
  document.querySelectorAll('.company-logo').forEach((card, index) => {
    ;(card as HTMLElement).style.animationDelay = `${index * 0.1}s`
  })
</script>
